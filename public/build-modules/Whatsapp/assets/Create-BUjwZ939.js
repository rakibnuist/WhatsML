import{T,l as $,r as C,m as U,c as n,o as l,b as m,d as r,g as d,k as u,u as t,F as D,f as L,t as R,i as B,e as F}from"./app-fEKA3BkQ.js";import{_ as N}from"./MultiSelect-D4amtqCA.js";import{_ as j}from"./SpinnerBtn-BezRkGQj.js";import{_ as O}from"./BlankLayout-CgEiBQ1a.js";import{a as P}from"./PageHeader-DmRLoM5E.js";import{S as c}from"./SelectField-b39MFXJO.js";import{_ as A}from"./ShortCodes-DozWnzPr.js";import K from"./TemplateMessage-BervSzlz.js";import{_ as q}from"./CreateForm-Bef851jc.js";import z from"./InteractiveMessage-GTvMPNF-.js";import{_ as G}from"./TemplateComponent-B5sKuil9.js";import{V as H}from"./ValidationErrors-B24rcOPH.js";import"./assetStore-BSVLrDIW.js";import"./InputField-ByPNVu2m.js";import"./AssetInput-EWE_Aw8o.js";import"./InputField-C_K5Mgww.js";const I={class:"p-4 sm:p-6"},J={class:"mt-8 grid grid-cols-2 place-items-start gap-6 md:grid-cols-12"},Q={class:"card col-span-full flex flex-col gap-4 px-4 pb-8 pt-4 md:col-span-4"},W={key:0,class:"col-span-full w-full md:col-span-8"},X={key:0,class:"grid grid-cols-2 place-items-start gap-3 lg:grid-cols-3"},Y={class:"col-span-full w-full lg:col-span-2"},Z={class:"whatsapp-chat-body col-span-full w-full rounded-md p-6 lg:col-span-1"},ee={for:""},te={key:0,class:"text-red-500"},ae={class:"mt-4 flex justify-end"},Ve=Object.assign({layout:O},{__name:"Create",props:["devices","autoReply"],setup(v){var V;const o=v,e=T({platform_id:"",keywords:[],match_type:"",message_type:"text",message_template:void 0,template_id:void 0,meta:{},status:"active",_method:"POST"}),g=!!((V=o.autoReply)!=null&&V.id);$(()=>{g&&(e.platform_id=o.autoReply.platform_id,e.keywords=o.autoReply.keywords??[],e.match_type=o.autoReply.match_type,e.message_type=o.autoReply.message_type,e.message_template=o.autoReply.message_template??"",e.template_id=o.autoReply.template_id,e.meta=o.autoReply.meta,e.status=o.autoReply.status,e._method="PUT",o.autoReply.message_type!="text"&&y())});const f=C([]),y=async i=>{var a;if(!e.platform_id||e.message_type=="text"){console.log("ignore");return}try{const p=await U.get(`/user/whatsapp/get-device-template-list/?platform_id=${e.platform_id}&type=${e.message_type}`);f.value=p.data,i&&(e.meta=((a=f.value.find(_=>_.id==e.template_id))==null?void 0:a.meta)||[])}catch(p){console.error(p)}},E=()=>{let i=route("user.whatsapp.auto-replies.store");g&&(i=route("user.whatsapp.auto-replies.update",o.autoReply.id)),e.post(i)};return(i,a)=>{var p,_,k,w,x,h,M,b,S;return l(),n("main",I,[m(P),m(H),r("form",{onSubmit:F(E,["prevent"])},[r("div",J,[r("div",Q,[m(c,{label:"Select A Device",modelValue:t(e).platform_id,"onUpdate:modelValue":a[0]||(a[0]=s=>t(e).platform_id=s),placeholder:"SELECT",validationMessage:(p=t(e).errors)==null?void 0:p.platform_id,options:v.devices},null,8,["modelValue","validationMessage","options"]),m(N,{label:"Keywords",modelValue:t(e).keywords,"onUpdate:modelValue":a[1]||(a[1]=s=>t(e).keywords=s),placeholder:"enter keywords",validationMessage:(_=t(e).errors)==null?void 0:_.keywords,options:t(e).keywords},null,8,["modelValue","validationMessage","options"]),m(c,{label:"Message Type",modelValue:t(e).message_type,"onUpdate:modelValue":a[2]||(a[2]=s=>t(e).message_type=s),placeholder:"SELECT",onChange:y,validationMessage:(k=t(e).errors)==null?void 0:k.message_type,options:["text","template","interactive"]},null,8,["modelValue","validationMessage"]),t(e).message_type!="text"?(l(),u(c,{key:0,label:"Select a Template",modelValue:t(e).template_id,"onUpdate:modelValue":a[3]||(a[3]=s=>t(e).template_id=s),onChange:a[4]||(a[4]=s=>y(s.target.value)),placeholder:"SELECT",validationMessage:(w=t(e).errors)==null?void 0:w.template_id,options:f.value},null,8,["modelValue","validationMessage","options"])):d("",!0),m(c,{label:"Status",modelValue:t(e).status,"onUpdate:modelValue":a[5]||(a[5]=s=>t(e).status=s),placeholder:"SELECT",validationMessage:(x=t(e).errors)==null?void 0:x.status,options:["active","inactive"]},null,8,["modelValue","validationMessage"])]),t(e).meta?(l(),n("div",W,[t(e).message_type!="text"?(l(),n("div",X,[r("div",Y,[t(e).message_type=="interactive"?(l(),u(q,{key:0,meta:t(e).meta},null,8,["meta"])):(l(),u(G,{key:1,components:((h=t(e).meta)==null?void 0:h.components)??[],errors:t(e).errors},null,8,["components","errors"]))]),r("div",Z,[t(e).message_type=="interactive"?(l(),u(z,{key:0,components:t(e).meta},null,8,["components"])):(l(),u(K,{key:1,templateData:((M=t(e).meta)==null?void 0:M.components)??[]},null,8,["templateData"]))])])):d("",!0),t(e).message_type=="text"?(l(),n(D,{key:1},[r("label",ee,R(i.trans("Message")),1),L(r("textarea",{class:"input","onUpdate:modelValue":a[6]||(a[6]=s=>t(e).message_template=s),rows:"5"},null,512),[[B,t(e).message_template]]),(b=t(e).errors)!=null&&b.message_template?(l(),n("div",te,R((S=t(e).errors)==null?void 0:S.message_template),1)):d("",!0),m(A,{modelValue:t(e).message_template,"onUpdate:modelValue":a[7]||(a[7]=s=>t(e).message_template=s)},null,8,["modelValue"])],64)):d("",!0),r("div",ae,[m(j,{processing:t(e).processing,"btn-text":g?"Update":"Create"},null,8,["processing","btn-text"])])])):d("",!0)])],32)])}}});export{Ve as default};
