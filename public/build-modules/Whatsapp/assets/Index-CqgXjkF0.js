import{_ as K}from"./Paginate-D_g9VFI3.js";import{_ as X}from"./NoDataFound-Xi4CpDbx.js";import{T as Z,D as ee,p as H,a as A,k as C,o as r,w as k,d as e,e as te,c as d,g as m,t as a,u as n,b as _,f as g,i as S,v as y,F as h,h as f,r as se,n as x,j as ae}from"./app-fEKA3BkQ.js";import{_ as oe}from"./PageHeader-DmRLoM5E.js";import{_ as le}from"./SpinnerBtn-BezRkGQj.js";import{s as Q,u as G}from"./assetStore-BSVLrDIW.js";import{_ as ne}from"./FilterDropdown-zriyDhiF.js";import{_ as re}from"./UserLayout-D_lxcpvH.js";import{_ as de}from"./NotificationRing-DGOcuzJf.js";import"./ValidationErrors-B24rcOPH.js";import"./echoServiceComposable-DxEMrh9X.js";const ie={key:0,class:"mb-2"},ue={for:"webhook",class:"label"},ce={class:"flex gap-1"},me=["value"],_e={key:1,class:"mb-2"},pe={for:"name",class:"label"},ge={class:"flex gap-2"},be={key:0,class:"mb-2"},he={for:"phone_number_id",class:"label"},ye=["value"],fe={key:1,class:"mb-2"},xe={for:"waba_id",class:"label"},ke=["value"],ve={key:2,class:"mb-2"},we={for:"business_id",class:"label"},$e=["value"],Me={key:2,class:"mb-2"},Se={for:"access_token",class:"label"},Ae={class:"text-md mb-2 mt-4 font-bold"},Ce={class:"mb-2"},De={value:!0},Re={value:!1},Ve={key:3,class:"mb-2"},Ne=["value"],Ie={key:0,class:"mb-2"},Te=["value"],Fe={key:1,class:"mb-2"},Pe=["value"],Ue={key:2,class:"mb-2"},je=["value"],Ee={class:"mb-2"},Be={value:!0},qe={value:!1},Le={key:0,class:"mt-2"},We={class:"mt-2 text-end"},Oe={__name:"PlatformSettingModal",props:{platform:{type:Object,required:!0},routeName:{type:String,required:!0},autoReplyMethods:{type:Array,default:["default"]},trainedAiModels:{type:Array,default:[]},chatFlows:{type:Array,default:[]},autoResponses:{type:Array,default:[]},module:{type:String,default:null},fields:{type:Array,default:[]}},setup(u){const{copyToClipboard:v}=Q(),w=G(),c=u,s=Z({name:"",access_token:"",send_auto_reply:!1,auto_reply_method:"",trained_ai:"",chat_flow:"",auto_response:"",send_welcome_message:!1,welcome_message_template:"",phone_number_id:"",waba_id:"",business_id:"",module:c.module});ee(()=>c.platform.id,()=>{var t;if((t=c.platform)!=null&&t.uuid){let l=c.platform.meta??{};s.name=c.platform.name,s.access_token=c.platform.access_token,s.send_auto_reply=l.send_auto_reply,s.auto_reply_method=l.auto_reply_method,s.trained_ai=l.trained_ai,s.chat_flow=l.chat_flow,s.auto_response=l.auto_response,s.send_welcome_message=l.send_welcome_message,s.welcome_message_template=l.welcome_message_template,s.phone_number_id=l.phone_number_id,s.waba_id=l.waba_id,s.business_id=l.business_account_id}});const $=()=>{s.put(route(c.routeName,c.platform.uuid),{onSuccess:()=>{w.close("platformSettingModal")}})},b=t=>c.fields.includes(t),M=H(()=>{let t=["default"];return c.trainedAiModels.length>0&&t.push("trained_ai"),c.chatFlows.length>0&&t.push("chat_flow"),c.autoResponses.length>0&&t.push("auto_response"),t});return(t,l)=>{const p=A("Icon");return r(),C(oe,{"header-state":!0,"header-title":"Platform Setting",state:"platformSettingModal"},{default:k(()=>[e("form",{onSubmit:te($,["prevent"])},[b("webhook_url")?(r(),d("div",ie,[e("label",ue,a(t.trans("Callback URL (read-only)")),1),e("div",ce,[e("input",{type:"text",class:"input",disabled:"",value:u.platform.webhook_url},null,8,me),e("button",{type:"button",class:"btn btn-secondary",onClick:l[0]||(l[0]=o=>n(v)(u.platform.webhook_url))},[_(p,{icon:"bx:copy",class:"text-xl"})])])])):m("",!0),b("name")?(r(),d("div",_e,[e("label",pe,a(t.trans("Platform Name")),1),g(e("input",{type:"text",class:"input","onUpdate:modelValue":l[1]||(l[1]=o=>n(s).name=o)},null,512),[[S,n(s).name]])])):m("",!0),e("div",ge,[b("phone_number_id")?(r(),d("div",be,[e("label",he,a(t.trans("Phone Number ID")),1),e("input",{type:"text",class:"input",value:n(s).phone_number_id,disabled:""},null,8,ye)])):m("",!0),b("waba_id")?(r(),d("div",fe,[e("label",xe,a(t.trans("Waba ID")),1),e("input",{type:"text",class:"input",value:n(s).waba_id,disabled:""},null,8,ke)])):m("",!0),b("business_id")?(r(),d("div",ve,[e("label",we,a(t.trans("Business ID")),1),e("input",{type:"text",class:"input",value:n(s).business_id,disabled:""},null,8,$e)])):m("",!0)]),b("access_token")?(r(),d("div",Me,[e("label",Se,a(t.trans("Access Token")),1),g(e("input",{type:"text",class:"input","onUpdate:modelValue":l[2]||(l[2]=o=>n(s).access_token=o)},null,512),[[S,n(s).access_token]])])):m("",!0),e("p",Ae,a(t.trans("Auto Reply Settings")),1),e("div",Ce,[e("label",null,a(t.trans("Send auto reply")),1),g(e("select",{class:"select","onUpdate:modelValue":l[3]||(l[3]=o=>n(s).send_auto_reply=o)},[e("option",De,a(t.trans("Yes")),1),e("option",Re,a(t.trans("No")),1)],512),[[y,n(s).send_auto_reply]]),e("small",null,a(t.trans("Enable or disable auto reply")),1)]),n(s).send_auto_reply==!0?(r(),d("div",Ve,[e("label",null,a(t.trans("Auto reply method")),1),g(e("select",{class:"select","onUpdate:modelValue":l[4]||(l[4]=o=>n(s).auto_reply_method=o)},[(r(!0),d(h,null,f(M.value,o=>(r(),d("option",{value:o,key:o},a(o.replace("_"," ")),9,Ne))),128))],512),[[y,n(s).auto_reply_method]]),e("small",null,a(t.trans("How message will be replied")),1)])):m("",!0),n(s).send_auto_reply==!0?(r(),d(h,{key:4},[n(s).auto_reply_method=="trained_ai"?(r(),d("div",Ie,[e("label",null,a(t.trans("Trained AI")),1),g(e("select",{class:"select","onUpdate:modelValue":l[5]||(l[5]=o=>n(s).trained_ai=o)},[(r(!0),d(h,null,f(u.trainedAiModels,o=>(r(),d("option",{value:o.id,key:o.id},a(o.title),9,Te))),128))],512),[[y,n(s).trained_ai]]),e("small",null,a(t.trans("The AI model will be used")),1)])):m("",!0),n(s).auto_reply_method=="chat_flow"?(r(),d("div",Fe,[e("label",null,a(t.trans("Chat Flow")),1),g(e("select",{class:"select","onUpdate:modelValue":l[6]||(l[6]=o=>n(s).chat_flow=o)},[(r(!0),d(h,null,f(u.chatFlows,o=>(r(),d("option",{value:o.id,key:o.id},a(o.title),9,Pe))),128))],512),[[y,n(s).chat_flow]]),e("small",null,a(t.trans("The chat flow will be used")),1)])):m("",!0),n(s).auto_reply_method=="auto_response"?(r(),d("div",Ue,[e("label",null,a(t.trans("Auto response Dataset")),1),g(e("select",{class:"select","onUpdate:modelValue":l[7]||(l[7]=o=>n(s).auto_response=o)},[(r(!0),d(h,null,f(u.autoResponses,o=>(r(),d("option",{value:o.id,key:o.id},a(o.title),9,je))),128))],512),[[y,n(s).auto_response]]),e("small",null,a(t.trans("The auto response dataset will be used")),1)])):m("",!0)],64)):m("",!0),e("div",Ee,[e("label",null,a(t.trans("Send Welcome message")),1),g(e("select",{class:"select","onUpdate:modelValue":l[8]||(l[8]=o=>n(s).send_welcome_message=o)},[e("option",Be,a(t.trans("Yes")),1),e("option",qe,a(t.trans("No")),1)],512),[[y,n(s).send_welcome_message]]),n(s).send_welcome_message===!0?(r(),d("div",Le,[g(e("textarea",{"onUpdate:modelValue":l[9]||(l[9]=o=>n(s).welcome_message_template=o),class:"input",rows:"5"},null,512),[[S,n(s).welcome_message_template]]),e("small",null,a(t.trans("This message will be sent to new users")),1)])):m("",!0)]),e("div",We,[_(le,{classes:"btn btn-primary",processing:n(s).processing,"btn-text":t.trans("Submit")},null,8,["processing","btn-text"])])],32)]),_:1})}}},ze={class:"mt-4 flex w-full flex-col gap-4"},Ye={key:0,class:"grid grid-cols-1 gap-4 xl:grid-cols-2 2xl:grid-cols-3"},He={class:"flex items-start justify-between"},Qe={class:"flex flex-col"},Ge=["title"],Je={class:"flex gap-2"},Ke=["onClick"],Xe=["onClick"],Ze={class:"mt-4 grid grid-cols-2 gap-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-3"},et={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},tt={class:"mb-1 text-xs font-medium text-gray-500"},st={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},at={class:"mb-1 text-xs font-medium text-gray-500"},ot={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},lt={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},nt={class:"mb-1 text-xs font-medium text-gray-500"},rt={class:"truncate text-sm font-semibold text-gray-900 dark:text-gray-100"},dt={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},it={class:"mb-1 text-xs font-medium text-gray-500"},ut={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},ct={class:"mb-1 text-xs font-medium text-gray-500"},mt={class:"truncate text-xs font-semibold text-gray-900 dark:text-gray-100"},_t={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},pt={class:"mb-1 text-xs font-medium text-gray-500"},gt={class:"truncate text-xs font-semibold text-gray-900 dark:text-gray-100"},bt={key:0,class:"mt-2 rounded-lg bg-purple-50 p-3 dark:bg-purple-900/20"},ht={class:"flex items-start gap-2"},yt={class:"flex flex-col"},ft={class:"text-xs font-medium text-purple-700 dark:text-purple-400"},xt={class:"text-sm text-purple-900 dark:text-purple-100"},kt={class:"w-full"},Tt=Object.assign({layout:re},{__name:"Index",props:["platforms","aiTrainings","autoResponses","flows"],setup(u){const v=G(),{deleteRow:w,textExcerpt:c}=Q(),s=se({}),$=t=>{s.value=t,v.open("platformSettingModal")},b=[{label:"Name",value:"name"},{label:"Status",value:"status"}],M=H(()=>{var p,o;let t=["name","phone_number_id","webhook_url","verify_token"];return((o=(p=s.value)==null?void 0:p.meta)==null?void 0:o.type)!=="whatsapp_es"&&t.push("access_token"),t});return(t,l)=>{var D,R,V;const p=A("Icon"),o=A("Link");return r(),d(h,null,[_(de),_(ne,{options:b}),e("div",ze,[u.platforms&&((D=u.platforms)!=null&&D.data.length)?(r(),d("div",Ye,[(r(!0),d(h,null,f(u.platforms.data,(i,J)=>{var N,I,T,F,P,U,j,E,B,q,L,W,O,z,Y;return r(),d("div",{key:J,class:"card card-body group flex flex-col gap-3 rounded-2xl border border-gray-100 bg-white p-6 shadow-sm transition-all duration-200 hover:shadow-md dark:border-gray-800 dark:bg-gray-900"},[e("div",He,[e("div",Qe,[e("h4",{title:i.name,class:"max-w-52 truncate font-semibold capitalize text-gray-900 dark:text-gray-100 2xl:text-lg"},a(i.name),9,Ge),e("span",{class:x(["mt-1 inline-flex w-fit items-center rounded-full px-2 py-px text-xs lowercase",{"bg-emerald-100 text-emerald-700":(N=i.meta)==null?void 0:N.webhook_connected,"bg-red-100 text-red-700":!((I=i.meta)!=null&&I.webhook_connected)}])},[e("span",{class:x(["mr-1 mt-0.5 h-2 w-2 rounded-full",{"bg-emerald-500":(T=i.meta)==null?void 0:T.webhook_connected,"bg-red-500":!((F=i.meta)!=null&&F.webhook_connected)}])},null,2),ae(" "+a((P=i.meta)!=null&&P.webhook_connected?"Connected":"Disconnected"),1)],2)]),e("div",Je,[_(o,{class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-gray-100 hover:text-blue-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-blue-400",href:t.route("user.whatsapp.platforms.show",i.uuid),title:"View Messages"},{default:k(()=>[_(p,{icon:"bx:message-square-dots",class:"text-xl"})]),_:2},1032,["href"]),_(o,{title:"QR Codes",class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-gray-100 hover:text-indigo-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-indigo-400",href:t.route("user.whatsapp.qr-codes.index",i.uuid)},{default:k(()=>[_(p,{icon:"bx:qr"})]),_:2},1032,["href"]),_(o,{title:"Message Logs",class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-gray-100 hover:text-indigo-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-indigo-400",href:t.route("user.whatsapp.platforms.logs",i.uuid)},{default:k(()=>[_(p,{icon:"bx:detail",class:"text-xl"})]),_:2},1032,["href"]),e("button",{class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-gray-100 hover:text-emerald-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-emerald-400",onClick:()=>$(i),title:"Settings"},[_(p,{icon:"bx:cog",class:"text-xl"})],8,Ke),e("button",{title:"Delete Platform",type:"button",onClick:vt=>n(w)(t.route("user.whatsapp.platforms.destroy",i)),class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-red-50 hover:text-red-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-red-900/20 dark:hover:text-red-400"},[_(p,{icon:"bx:trash",class:"text-xl"})],8,Xe)])]),e("div",Ze,[e("div",et,[e("span",tt,a(t.trans("Auto Reply")),1),e("span",{class:x(["text-sm font-semibold",(U=i.meta)!=null&&U.send_auto_reply?"text-emerald-600":"text-red-600"])},a((j=i.meta)!=null&&j.send_auto_reply?"Enabled":"Disabled"),3)]),e("div",st,[e("span",at,a(t.trans("Reply Method")),1),e("span",ot,a((E=i.meta)==null?void 0:E.auto_reply_method),1)]),e("div",lt,[e("span",nt,a(t.trans("Dataset")),1),e("span",rt,a(n(c)((B=i.meta)==null?void 0:B.auto_reply_dataset_name,15)),1)]),e("div",dt,[e("span",it,a(t.trans("Welcome Message")),1),e("span",{class:x(["text-sm font-semibold",(q=i.meta)!=null&&q.send_welcome_message?"text-emerald-600":"text-red-600"])},a((L=i.meta)!=null&&L.send_welcome_message?"Enabled":"Disabled"),3)]),e("div",ut,[e("span",ct,a(t.trans("Phone Number ID")),1),e("span",mt,a((W=i.meta)==null?void 0:W.phone_number_id),1)]),e("div",_t,[e("span",pt,a(t.trans("WABA ID")),1),e("span",gt,a((O=i.meta)==null?void 0:O.business_account_id),1)])]),(z=i.meta)!=null&&z.send_welcome_message?(r(),d("div",bt,[e("div",ht,[_(p,{icon:"bx:message-rounded-dots",class:"mt-0.5 text-lg text-purple-500"}),e("div",yt,[e("span",ft,a(t.trans("Welcome Message")),1),e("span",xt,a((Y=i.meta)==null?void 0:Y.welcome_message_template),1)])])])):m("",!0)])}),128))])):(r(),C(X,{key:1})),e("div",kt,[(V=(R=u.platforms)==null?void 0:R.data)!=null&&V.length?(r(),C(K,{key:0,links:u.platforms.links},null,8,["links"])):m("",!0)])]),_(Oe,{platform:s.value,autoReplyMethods:["default","trained_ai","chat_flow","auto_response"],trainedAiModels:u.aiTrainings,chatFlows:u.flows,autoResponses:u.autoResponses,routeName:"user.whatsapp.platforms.update",fields:M.value},null,8,["platform","trainedAiModels","chatFlows","autoResponses","fields"])],64)}}});export{Tt as default};
