import{k as v,p as k,r as y,c as n,o as a,b as o,f as d,e as x,v as C,u as s,t as l,F as m,g as h,d as S,a as u,h as F,i as B,n as p,j as L,B as M}from"./app-B4kV47qU.js";import{_ as N,H as V}from"./IntersectionObserver-DbdokySM.js";import{s as z}from"./sharedComposable-VJJUONp6.js";import{u as j}from"./chatStore-CTtmOQOw.js";import{h as I}from"./moment-BAtM24Ew.js";import{u as T}from"./modalStore-BgORG3Nn.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./toastComposable-CvcyPmJb.js";import"./echoServiceComposable-n1MnmRL6.js";const U={class:"relative mb-3"},D={class:"mb-2 flex items-center gap-2 text-nowrap"},O={value:""},P=["value"],R={class:"flex h-full items-center px-3"},$={class:"styled-scrollbar h-[88%] overflow-y-auto pb-4"},A=["onClick"],H={class:"avatar avatar-circle shrink-0"},E=["src"],Q={class:"absolute -right-2 bottom-0 rounded-full bg-white p-1"},q={class:"ml-4 mr-2 flex-grow overflow-x-hidden"},G={class:"truncate text-xs font-normal text-gray-500"},J={class:"flex flex-col items-end"},K={key:0,class:"flex h-5 w-5 items-center justify-center rounded-full bg-danger-500 text-xs font-normal text-white"},W={class:"py-1"},X={key:0},Y={key:1,class:"text-center text-sm text-slate-400"},ue={__name:"LeftSidebar",props:{conversations:{type:Array,default:[]}},setup(Z){const _=T();z();const t=j(),w=v(null);return v(null),k(()=>{let i=new URLSearchParams(window.location.search);t.searchForm.badge_id=i.get("badge_id")||"",t.searchForm.customer_name=i.get("customer_name")||""}),(i,r)=>{const c=y("Icon");return a(),n(m,null,[o("div",{id:"chat-sidebar",class:p(["absolute z-30 h-[calc(100vh-11rem)] w-3/4 rounded-md bg-white p-3 transition-all duration-300 dark:bg-dark-800 sm:w-72 lg:relative xl:w-3/12",[s(t).leftSidebar.isOpen?"translate-x-0":"translate-x-[-110%]","lg:translate-x-0"]])},[o("div",U,[o("div",D,[x(o("select",{class:"select","onUpdate:modelValue":r[0]||(r[0]=e=>s(t).searchForm.badge_id=e),onChange:r[1]||(r[1]=(...e)=>i.getFilteredConversations&&i.getFilteredConversations(...e))},[o("option",O,l(i.trans("Filter by badge")),1),(a(!0),n(m,null,h(s(t).badges,e=>(a(),n("option",{value:e.id,key:e.id},l(e.text),9,P))),128))],544),[[C,s(t).searchForm.badge_id]]),o("button",{class:"btn btn-primary",onClick:r[2]||(r[2]=e=>s(_).open("badgeModal"))},"+")]),o("form",{onSubmit:r[4]||(r[4]=S(()=>{},["prevent"])),class:"group flex h-10 w-full items-center overflow-hidden rounded-primary border border-transparent bg-slate-100 shadow-sm focus-within:border-primary-500 focus-within:ring-1 focus-within:ring-primary-500 dark:border-transparent dark:bg-dark-900 dark:focus-within:border-primary-500"},[r[7]||(r[7]=o("div",{class:"mb-2"},null,-1)),o("div",R,[u(c,{icon:"fe:search",class:"text-lg text-slate-400 group-focus-within:text-primary-500"})]),x(o("input",{class:"h-full w-full border-transparent bg-transparent px-0 text-sm placeholder-slate-400 placeholder:text-sm focus:border-transparent focus:outline-none focus:ring-0",type:"text","onUpdate:modelValue":r[3]||(r[3]=e=>s(t).searchForm.customer_name=e),placeholder:"Search"},null,512),[[F,s(t).searchForm.customer_name]])],32),s(t).leftSidebar.isOpen?(a(),n("button",{key:0,id:"chat-btn-hide-sidebar",type:"button",onClick:r[5]||(r[5]=(...e)=>s(t).toggleLeftSidebar&&s(t).toggleLeftSidebar(...e)),class:"absolute left-full top-1 z-20 inline-flex h-8 w-8 translate-x-4 items-center justify-center rounded-full bg-black/60 text-white dark:text-slate-300 xl:hidden"},[u(c,{icon:"fe:close"})])):d("",!0)]),o("div",$,[o("ul",{id:"chat-list",ref_key:"scrollContainerRef",ref:w},[(a(!0),n(m,null,h(s(t).filteredConversations,e=>{var f,g,b;return a(),n("li",{class:p(["group",{active:((f=s(t).activeConversation)==null?void 0:f.id)==e.id}]),key:e.id},[o("a",{onClick:ee=>s(t).setActiveConversation(e),class:"inline-flex w-full items-start justify-between rounded-md bg-transparent px-3 py-3 transition-colors duration-150 hover:bg-slate-100 group-[.active]:bg-slate-100 dark:hover:bg-[#242424] group-[.active]:dark:bg-dark-900"},[o("div",H,[o("img",{class:"avatar-img relative",src:s(t).getConversationProfilePic(e)},null,8,E),o("div",Q,[u(c,{icon:"ri:whatsapp-fill",class:"text-[#00c67e]"})])]),o("div",q,[o("p",{class:p(["whitespace-nowrap text-sm text-slate-800 dark:text-slate-100",[e.unreadCount>0?"font-semibold":"font-medium"]])},[L(l(e.name??e.id.split("@")[0].substring(2)??"Unknown")+" ",1),o("span",{class:"rounded p-0 px-2 text-sm text-white",style:M({background:(g=s(t).getBadge(e==null?void 0:e.badge_id))==null?void 0:g.color})},l((b=s(t).getBadge(e==null?void 0:e.badge_id))==null?void 0:b.text),5)],2),o("span",G,l(e.conversationTimestamp?s(I).unix(e.conversationTimestamp).local().fromNow():""),1)]),o("div",J,[e.unreadCount>0?(a(),n("span",K,l(e.unreadCount??""),1)):d("",!0)])],8,A)],2)}),128)),o("li",W,[u(N,{intersectionStart:0,afterIntersection:s(t).loadMoreConversations,loader:s(t).loading.conversations},null,8,["afterIntersection","loader"])]),s(t).filteredConversations||s(t).searchForm.customer_name.length>0||s(t).searchForm.badge_id>0?(a(),n("li",X,[s(t).loading.searching?(a(),B(V,{key:0,class:"mx-auto"})):s(t).filteredConversations.length==0?(a(),n("div",Y,l(i.trans("No results found")),1)):d("",!0)])):d("",!0)],512)])],2),s(t).leftSidebar.isOpen?(a(),n("div",{key:0,onClick:r[6]||(r[6]=(...e)=>s(t).toggleLeftSidebar&&s(t).toggleLeftSidebar(...e)),class:"absolute bottom-0 left-0 right-0 top-0 z-10 h-full w-full bg-black/20 transition-colors duration-300 ease-in-out xl:hidden"})):d("",!0)],64)}}};export{ue as default};
