import{_ as Y}from"./Paginate-DtQjslkz.js";import{_ as H}from"./NoDataFound-su6Kbmdk.js";import{s as L}from"./sharedComposable-VJJUONp6.js";import{_ as G}from"./FilterDropdown-B678SkyV.js";import{_ as J}from"./UserLayout-DG2qUs8x.js";import{T as K,q as Q,l as X,r as S,i as A,o as r,w as N,b as e,d as Z,c as d,f as u,t as a,u as n,a as _,e as p,h as M,v as y,F as h,g as f,k as ee,n as v,j as te,_ as se}from"./app-B4kV47qU.js";import{_ as ae}from"./Modal-ChMy0A7y.js";import{_ as oe}from"./SpinnerBtn-B3fjBeDL.js";import{u as W}from"./modalStore-BgORG3Nn.js";import{_ as le}from"./NotificationRing-CraudT8E.js";import{t as q}from"./toastComposable-CvcyPmJb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ToastrContainer-Cfx6wOd2.js";import"./AssetModal-vtiWQmiY.js";import"./IntersectionObserver-DbdokySM.js";import"./assetStore-cDK0Afhq.js";import"./echoServiceComposable-n1MnmRL6.js";const ne={key:0,class:"mb-2"},re={for:"webhook",class:"label"},ie={class:"flex gap-1"},de=["value"],ue={key:1,class:"mb-2"},ce={for:"name",class:"label"},me={class:"flex gap-2"},_e={key:0,class:"mb-2"},pe={for:"phone_number_id",class:"label"},be=["value"],ge={key:1,class:"mb-2"},he={for:"waba_id",class:"label"},ye=["value"],fe={key:2,class:"mb-2"},ve={for:"business_id",class:"label"},xe=["value"],ke={key:2,class:"mb-2"},we={for:"access_token",class:"label"},$e={class:"text-md mb-2 mt-4 font-bold"},Me={class:"mb-2"},Se={value:!0},Ae={value:!1},Ne={key:3,class:"mb-2"},Ce=["value"],Ve={key:0,class:"mb-2"},Re=["value"],Te={key:1,class:"mb-2"},je=["value"],Ie={key:2,class:"mb-2"},Ue=["value"],De={class:"mb-2"},Fe={value:!0},Pe={value:!1},Be={key:0,class:"mt-2"},Ee={class:"mt-2 text-end"},qe={__name:"PlatformSettingModal",props:{platform:{type:Object,required:!0},routeName:{type:String,required:!0},autoReplyMethods:{type:Array,default:["default"]},trainedAiModels:{type:Array,default:[]},chatFlows:{type:Array,default:[]},autoResponses:{type:Array,default:[]},module:{type:String,default:null},fields:{type:Array,default:[]}},setup(c){const{copyToClipboard:x}=L(),k=W(),m=c,s=K({name:"",access_token:"",send_auto_reply:!1,auto_reply_method:"",trained_ai:"",chat_flow:"",auto_response:"",send_welcome_message:!1,welcome_message_template:"",phone_number_id:"",waba_id:"",business_id:"",module:m.module});Q(()=>m.platform.id,()=>{var t;if((t=m.platform)!=null&&t.uuid){let l=m.platform.meta??{};s.name=m.platform.name,s.access_token=m.platform.access_token,s.send_auto_reply=l.send_auto_reply,s.auto_reply_method=l.auto_reply_method,s.trained_ai=l.trained_ai,s.chat_flow=l.chat_flow,s.auto_response=l.auto_response,s.send_welcome_message=l.send_welcome_message,s.welcome_message_template=l.welcome_message_template,s.phone_number_id=l.phone_number_id,s.waba_id=l.waba_id,s.business_id=l.business_account_id}});const w=()=>{s.put(route(m.routeName,m.platform.uuid),{onSuccess:()=>{k.close("platformSettingModal")}})},b=t=>m.fields.includes(t),$=X(()=>{let t=["default"];return m.trainedAiModels.length>0&&t.push("trained_ai"),m.chatFlows.length>0&&t.push("chat_flow"),m.autoResponses.length>0&&t.push("auto_response"),t});return(t,l)=>{const g=S("Icon");return r(),A(ae,{"header-state":!0,"header-title":"Platform Setting",state:"platformSettingModal"},{default:N(()=>[e("form",{onSubmit:Z(w,["prevent"])},[b("webhook_url")?(r(),d("div",ne,[e("label",re,a(t.trans("Callback URL (read-only)")),1),e("div",ie,[e("input",{type:"text",class:"input",disabled:"",value:c.platform.webhook_url},null,8,de),e("button",{type:"button",class:"btn btn-secondary",onClick:l[0]||(l[0]=o=>n(x)(c.platform.webhook_url))},[_(g,{icon:"bx:copy",class:"text-xl"})])])])):u("",!0),b("name")?(r(),d("div",ue,[e("label",ce,a(t.trans("Platform Name")),1),p(e("input",{type:"text",class:"input","onUpdate:modelValue":l[1]||(l[1]=o=>n(s).name=o)},null,512),[[M,n(s).name]])])):u("",!0),e("div",me,[b("phone_number_id")?(r(),d("div",_e,[e("label",pe,a(t.trans("Phone Number ID")),1),e("input",{type:"text",class:"input",value:n(s).phone_number_id,disabled:""},null,8,be)])):u("",!0),b("waba_id")?(r(),d("div",ge,[e("label",he,a(t.trans("Waba ID")),1),e("input",{type:"text",class:"input",value:n(s).waba_id,disabled:""},null,8,ye)])):u("",!0),b("business_id")?(r(),d("div",fe,[e("label",ve,a(t.trans("Business ID")),1),e("input",{type:"text",class:"input",value:n(s).business_id,disabled:""},null,8,xe)])):u("",!0)]),b("access_token")?(r(),d("div",ke,[e("label",we,a(t.trans("Access Token")),1),p(e("input",{type:"text",class:"input","onUpdate:modelValue":l[2]||(l[2]=o=>n(s).access_token=o)},null,512),[[M,n(s).access_token]])])):u("",!0),e("p",$e,a(t.trans("Auto Reply Settings")),1),e("div",Me,[e("label",null,a(t.trans("Send auto reply")),1),p(e("select",{class:"select","onUpdate:modelValue":l[3]||(l[3]=o=>n(s).send_auto_reply=o)},[e("option",Se,a(t.trans("Yes")),1),e("option",Ae,a(t.trans("No")),1)],512),[[y,n(s).send_auto_reply]]),e("small",null,a(t.trans("Enable or disable auto reply")),1)]),n(s).send_auto_reply==!0?(r(),d("div",Ne,[e("label",null,a(t.trans("Auto reply method")),1),p(e("select",{class:"select","onUpdate:modelValue":l[4]||(l[4]=o=>n(s).auto_reply_method=o)},[(r(!0),d(h,null,f($.value,o=>(r(),d("option",{value:o,key:o},a(o.replace("_"," ")),9,Ce))),128))],512),[[y,n(s).auto_reply_method]]),e("small",null,a(t.trans("How message will be replied")),1)])):u("",!0),n(s).send_auto_reply==!0?(r(),d(h,{key:4},[n(s).auto_reply_method=="trained_ai"?(r(),d("div",Ve,[e("label",null,a(t.trans("Trained AI")),1),p(e("select",{class:"select","onUpdate:modelValue":l[5]||(l[5]=o=>n(s).trained_ai=o)},[(r(!0),d(h,null,f(c.trainedAiModels,o=>(r(),d("option",{value:o.id,key:o.id},a(o.title),9,Re))),128))],512),[[y,n(s).trained_ai]]),e("small",null,a(t.trans("The AI model will be used")),1)])):u("",!0),n(s).auto_reply_method=="chat_flow"?(r(),d("div",Te,[e("label",null,a(t.trans("Chat Flow")),1),p(e("select",{class:"select","onUpdate:modelValue":l[6]||(l[6]=o=>n(s).chat_flow=o)},[(r(!0),d(h,null,f(c.chatFlows,o=>(r(),d("option",{value:o.id,key:o.id},a(o.title),9,je))),128))],512),[[y,n(s).chat_flow]]),e("small",null,a(t.trans("The chat flow will be used")),1)])):u("",!0),n(s).auto_reply_method=="auto_response"?(r(),d("div",Ie,[e("label",null,a(t.trans("Auto response Dataset")),1),p(e("select",{class:"select","onUpdate:modelValue":l[7]||(l[7]=o=>n(s).auto_response=o)},[(r(!0),d(h,null,f(c.autoResponses,o=>(r(),d("option",{value:o.id,key:o.id},a(o.title),9,Ue))),128))],512),[[y,n(s).auto_response]]),e("small",null,a(t.trans("The auto response dataset will be used")),1)])):u("",!0)],64)):u("",!0),e("div",De,[e("label",null,a(t.trans("Send Welcome message")),1),p(e("select",{class:"select","onUpdate:modelValue":l[8]||(l[8]=o=>n(s).send_welcome_message=o)},[e("option",Fe,a(t.trans("Yes")),1),e("option",Pe,a(t.trans("No")),1)],512),[[y,n(s).send_welcome_message]]),n(s).send_welcome_message===!0?(r(),d("div",Be,[p(e("textarea",{"onUpdate:modelValue":l[9]||(l[9]=o=>n(s).welcome_message_template=o),class:"input",rows:"5"},null,512),[[M,n(s).welcome_message_template]]),e("small",null,a(t.trans("This message will be sent to new users")),1)])):u("",!0)]),e("div",Ee,[_(oe,{classes:"btn btn-primary",processing:n(s).processing,"btn-text":t.trans("Submit")},null,8,["processing","btn-text"])])],32)]),_:1})}}},Le={class:"mt-4 flex w-full flex-col gap-4"},We={key:0,class:"grid grid-cols-1 gap-4 xl:grid-cols-2 2xl:grid-cols-3"},Oe={class:"flex flex-col items-start justify-between gap-2 sm:flex-row sm:items-center"},ze={class:"flex items-center gap-4"},Ye={class:"flex flex-col"},He={class:"font-bold capitalize text-gray-900 dark:text-gray-100"},Ge={class:"text-xs"},Je={class:"mt-4 flex items-center justify-around gap-2"},Ke=["onClick"],Qe=["onClick"],Xe=["onClick"],Ze={class:"mt-4 grid grid-cols-2 gap-2 md:grid-cols-3"},et={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},tt={class:"text-xs font-medium text-gray-500"},st={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},at={class:"text-xs font-medium text-gray-500"},ot={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},lt={class:"text-xs font-medium text-gray-500"},nt={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},rt={key:0,class:"mt-2 rounded-lg bg-purple-50 p-3 dark:bg-purple-900/20"},it={class:"flex items-start gap-2"},dt={class:"flex flex-col"},ut={class:"text-xs font-medium text-purple-700 dark:text-purple-400"},ct={class:"text-sm text-purple-900 dark:text-purple-100"},mt={class:"w-full"},Vt=Object.assign({layout:J},{__name:"Index",props:["platforms","aiTrainings","autoResponses"],setup(c){const x=W(),{deleteRow:k,textExcerpt:m}=L(),s=ee({}),w=t=>{s.value=t,x.open("platformSettingModal")},b=[{label:"Name",value:"name"},{label:"Status",value:"status"}],$=t=>{axios.get(route("user.whatsapp-web.api.platforms.check-verification",t)).then(l=>{l.data.exists?(q.success("Number is verified"),se.reload()):q.danger("Number not verified")})};return(t,l)=>{var C,V,R;const g=S("Icon"),o=S("Link");return r(),d(h,null,[_(le,{module:"whatsapp-web"}),_(G,{options:b}),e("div",Le,[c.platforms&&((C=c.platforms)!=null&&C.data.length)?(r(),d("div",We,[(r(!0),d(h,null,f(c.platforms.data,(i,O)=>{var T,j,I,U,D,F,P,B,E;return r(),d("div",{key:O,class:"card card-body group flex flex-col gap-3 rounded-2xl border border-gray-100 bg-white p-6 shadow-sm transition-all duration-200 hover:shadow-md dark:border-gray-800 dark:bg-gray-900"},[e("div",Oe,[e("div",ze,[e("div",Ye,[e("p",He,a(n(m)(i.name,20)),1),e("span",Ge,a((T=i.meta)==null?void 0:T.phone_number),1),e("span",{class:v(["mt-1 inline-flex w-fit items-center rounded-full px-2 py-px text-xs lowercase",{"bg-emerald-100 text-emerald-700":i.status==="connected"||i.status==="verified","bg-red-100 text-red-700":["disconnected","inactive","unverified"].includes(i.status),"bg-yellow-100 text-yellow-700":i.status==="wait_for","bg-blue-100 text-blue-700":i.status==="pulling_wa_data"}])},[e("span",{class:v(["mr-1 mt-0.5 h-2 w-2 rounded-full",{"bg-emerald-500":i.status==="connected"||i.status==="verified","bg-red-500":["disconnected","inactive","unverified"].includes(i.status),"bg-yellow-500":i.status==="wait_for","bg-blue-500":i.status==="pulling_wa_data"}])},null,2),te(" "+a(i.status),1)],2)])]),e("div",Je,[_(o,{class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-gray-100 hover:text-blue-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-blue-400",href:t.route("user.whatsapp-web.platforms.conversations.index",i.uuid),title:"View Messages"},{default:N(()=>[_(g,{icon:"bx:message-square-dots",class:"text-xl"})]),_:2},1032,["href"]),_(o,{title:"Reconnect",class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-gray-100 hover:text-indigo-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-indigo-400",href:t.route("user.whatsapp-web.platforms.connection",i.uuid)},{default:N(()=>[_(g,{icon:"bx:refresh",class:"text-xl"})]),_:2},1032,["href"]),(j=i.meta)!=null&&j.verified?u("",!0):(r(),d("button",{key:0,title:"Verify Number",type:"button",class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-gray-100 hover:text-emerald-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-emerald-400",onClick:z=>$(i.uuid)},[_(g,{icon:"bx:check-shield",class:"text-xl"})],8,Ke)),e("button",{class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-gray-100 hover:text-emerald-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-emerald-400",onClick:()=>w(i),title:"Settings"},[_(g,{icon:"bx:cog",class:"text-xl"})],8,Qe),e("button",{title:"Delete Platform",type:"button",onClick:z=>n(k)(t.route("user.whatsapp-web.platforms.destroy",i)),class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-red-50 hover:text-red-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-red-900/20 dark:hover:text-red-400"},[_(g,{icon:"bx:trash",class:"text-xl"})],8,Xe)])]),e("div",Ze,[e("div",et,[e("span",tt,a(t.trans("Welcome Message")),1),e("span",{class:v(["text-sm font-semibold",(I=i.meta)!=null&&I.send_welcome_message?"text-emerald-600":"text-red-600"])},a((U=i.meta)!=null&&U.send_welcome_message?t.trans("Enabled"):t.trans("Disabled")),3)]),e("div",st,[e("span",at,a(t.trans("Auto Reply")),1),e("span",{class:v(["text-sm font-semibold",(D=i.meta)!=null&&D.send_auto_reply?"text-emerald-600":"text-red-600"])},a((F=i.meta)!=null&&F.send_auto_reply?t.trans("Enabled"):t.trans("Disabled")),3)]),e("div",ot,[e("span",lt,a(t.trans("Auto Reply Method")),1),e("span",nt,a((P=i.meta)==null?void 0:P.auto_reply_method),1)])]),(B=i.meta)!=null&&B.send_welcome_message?(r(),d("div",rt,[e("div",it,[_(g,{icon:"bx:message-rounded-dots",class:"mt-0.5 text-lg text-purple-500"}),e("div",dt,[e("span",ut,a(t.trans("Welcome Message")),1),e("span",ct,a((E=i.meta)==null?void 0:E.welcome_message_template),1)])])])):u("",!0)])}),128))])):(r(),A(H,{key:1})),e("div",mt,[(R=(V=c.platforms)==null?void 0:V.data)!=null&&R.length?(r(),A(Y,{key:0,links:c.platforms.links},null,8,["links"])):u("",!0)])]),_(qe,{platform:s.value,autoReplyMethods:["default","auto_response","trained_ai"],trainedAiModels:c.aiTrainings,routeName:"user.whatsapp-web.platforms.update",autoResponses:c.autoResponses,module:"whatsapp-web"},null,8,["platform","trainedAiModels","autoResponses"])],64)}}});export{Vt as default};
