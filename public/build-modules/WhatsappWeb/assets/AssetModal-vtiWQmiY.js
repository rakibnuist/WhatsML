import{e as N,J as W,c as l,o as t,t as f,n as $,k,l as O,r as L,b as s,f as c,i as P,j as q,d as J,a as g,u as i,B as G,F as z,g as U,M as H,w as K,h as Q}from"./app-B4kV47qU.js";import{s as X}from"./sharedComposable-VJJUONp6.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as Z}from"./Modal-ChMy0A7y.js";import{_ as ee}from"./IntersectionObserver-DbdokySM.js";import{u as te}from"./assetStore-cDK0Afhq.js";import{u as le}from"./modalStore-BgORG3Nn.js";const se={__name:"InputFieldError",props:{message:String,classes:String},setup(e){return(o,u)=>{var m;return N((t(),l("span",{class:$(["mt-1 block text-red-500 text-danger",e.classes])},f(e.message),3)),[[W,(m=e.message)==null?void 0:m.length]])}}},oe={class:"relative w-full"},ae=["for"],ne={key:0,class:"scale-110 text-red-500"},ie={class:"flex items-center gap-2"},re={key:0,class:"scale-75 text-xs"},de={class:"mt-2 line-clamp-1 text-sm"},ce=["multiple","accept"],ue={key:0,class:"absolute bottom-2 mx-auto w-11/12"},me={class:"translate-y-[-10.5px] whitespace-nowrap"},pe={class:"text-[10px] text-white"},fe={key:1,class:"mt-1 text-xs dark:text-gray-300"},be={class:"flex w-full justify-between border-b border-primary-300 py-1 dark:border-primary-600"},ve=["onClick"],xe=["src"],ge=["src"],ye={key:2,class:"flex h-full w-full items-center justify-center"},he=["src"],ke={key:3,class:"flex h-full items-center justify-center gap-1 rounded bg-white p-2 text-center text-xs text-black"},we={class:"line-clamp-1"},_e={key:0,class:"flex flex-wrap"},Se=["href"],Fe=["src"],$e=["href"],je=["src"],Ce={__name:"DropzoneInput",props:{modelValue:{type:[Array,String],default:()=>[]},accept:{type:String,default:"default"},multiple:{type:Boolean,default:!1},maxFiles:{type:Number,default:10},percentage:{type:Number,default:0},instantSubmit:Function,classes:{type:String,default:"min-h-28"},label:{type:String,default:""},subtitle:{type:String,default:null},labelClass:{type:String,default:""},required:{type:[Boolean,String],default:!1},uploadedFiles:{type:Array,default:()=>[]},error:{type:String,default:null},filePreviewPosition:{type:String,default:"top"}},emits:["update:modelValue"],setup(e,{emit:o}){const u=e,{textExcerpt:m}=X(),j=o,b=k(null),v=k(!1),x=k(!1),n=k(!1),y=k("No Files Selected"),C=k(u.error),A={image:"image/*",video:"video/*",audio:"audio/*",document:".pdf,.csv,.doc,.docx,.xls,.xlsx,.ppt,.pptx",documents:".pdf,.csv,.doc,.docx,.xls,.xlsx,.ppt,.pptx",pdf:".pdf",csv:".csv",doc:".doc,.docx",xls:".xls,.xlsx",ppt:".ppt,.pptx",default:"*/*"},B=O(()=>u.accept.split(",").map(d=>A[d]).join(",")),E=()=>{console.log(b.value.files),b.value.files.length&&(x.value=!0,R())},D=d=>{d.length===1?y.value=d[0].name:d.length>1?y.value=`${d.length} files selected`:y.value="No file selected"},R=()=>{const d=Array.from(b.value.files),a=u.multiple?u.maxFiles:1,p=u.modelValue||[],w=u.accept||"default",_=A[w].split(","),S=d.filter(r=>{const h="."+r.name.split(".").pop().toLowerCase();return!(_.includes("*/*")||_.some(V=>V.includes("/*")?r.type.startsWith(V.split("/")[0]):V.toLowerCase()===h))});if(S.length){const r=S.map(h=>h.name).join(", ");C.value=`Invalid files: ${r}. Supported files: ${A[w]}`;return}const F=[...p,...d].slice(-a);j("update:modelValue",F),D(F),u.instantSubmit&&u.instantSubmit()},I=d=>URL.createObjectURL(d),T=d=>{const a=[...u.modelValue],p=a.splice(d,1)[0];j("update:modelValue",a),D(a),p&&URL.revokeObjectURL(p),a.length===0&&(b.value.value="",n.value=!1,x.value=!1)};return(d,a)=>{var w,_,S,M,F;const p=L("Icon");return t(),l(z,null,[s("div",oe,[e.label?(t(),l("label",{key:0,for:e.label,class:$(["mb-1 block text-sm capitalize dark:text-dark-200",e.labelClass])},[q(f(e.label)+" ",1),e.required?(t(),l("span",ne,"*")):c("",!0)],10,ae)):c("",!0),s("div",{class:$(["dropzone-area relative flex cursor-pointer flex-col items-center justify-center rounded-xl border border-dashed border-dark-400 p-4 text-center dark:text-primary-50",[{"bg-blue-50 dark:bg-blue-800":v.value},e.classes]])},[s("div",{onDragover:a[0]||(a[0]=J(r=>v.value=!0,["prevent"])),onDragleave:a[1]||(a[1]=r=>v.value=!1),onDragend:a[2]||(a[2]=r=>v.value=!1),class:"flex flex-col items-center justify-center"},[s("div",ie,[g(p,{icon:"bx:upload",class:"mb-1 h-5 w-5"}),a[5]||(a[5]=s("p",{class:"text-xs font-semibold"},"Click or drag & drop",-1))]),e.multiple?(t(),l("small",re,"Max ("+f(e.maxFiles)+" files)",1)):c("",!0),s("p",de,f(((w=e.modelValue)==null?void 0:w.length)>0?i(m)(y.value,20):"No file selected"),1)],32),s("input",{type:"file",multiple:e.multiple,accept:B.value,ref_key:"fileInput",ref:b,onInput:E,"aria-label":"Upload files"},null,40,ce),e.percentage>0?(t(),l("div",ue,[s("div",{style:G({width:`${e.percentage}%`}),class:"h-3 w-1/2 rounded-full border border-dashed border-white bg-primary-500 transition-width"},[s("p",me,[s("span",pe,f(e.percentage)+" %",1)])],4)])):c("",!0),((_=e.modelValue)==null?void 0:_.length)>0&&!n.value&&x.value?(t(),l("button",{key:1,type:"button",class:"absolute right-2 top-1 text-xs underline",onClick:a[3]||(a[3]=r=>n.value=!0)},a[6]||(a[6]=[s("span",null,"Show files",-1)]))):c("",!0)],2),e.subtitle?(t(),l("p",fe,"*"+f(e.subtitle),1)):c("",!0),C.value?(t(),P(se,{key:2,message:C.value},null,8,["message"])):c("",!0),((S=e.modelValue)==null?void 0:S.length)>0&&n.value?(t(),l("div",{key:3,class:$(["styled-scrollbar card absolute left-0 z-50 mt-2 flex w-full flex-wrap gap-2 rounded-md bg-primary-200 p-2 dark:bg-dark-700/95 dark:text-primary-50",{"h-[25rem] overflow-y-auto":e.modelValue.length>4,"bottom-full":e.filePreviewPosition==="top","top-full":e.filePreviewPosition==="bottom"}])},[s("div",be,[a[8]||(a[8]=s("p",{class:"text-xs font-semibold"},"Uploaded Files",-1)),s("button",{onClick:a[4]||(a[4]=r=>n.value=!1),type:"button",class:"flex items-center justify-center text-red-500 hover:underline"},[g(p,{icon:"bx:x"}),a[7]||(a[7]=s("span",{class:"text-xs"},"Close",-1))])]),(t(!0),l(z,null,U(e.modelValue,(r,h)=>(t(),l("section",{class:"relative h-32 min-w-32 flex-1 rounded-md border border-slate-400 dark:border-slate-500",key:h},[s("button",{onClick:V=>T(h),type:"button",class:"absolute right-1 top-1 z-50 flex h-6 w-6 items-center justify-center rounded-full border border-red-500 text-red-500 hover:bg-red-500/10"},[g(p,{icon:"bx:x"})],8,ve),r.type.startsWith("image/")?(t(),l("img",{key:0,src:I(r),class:"h-full w-full rounded object-contain",alt:"img",loading:"lazy"},null,8,xe)):r.type.startsWith("video/")?(t(),l("video",{key:1,class:"h-full w-full rounded object-contain",src:I(r),width:"100%",height:"100%",controls:"",loading:"lazy"},null,8,ge)):r.type.startsWith("audio/")?(t(),l("div",ye,[s("audio",{src:I(r),class:"h-14 w-full",controls:""},null,8,he)])):(t(),l("div",ke,[g(p,{icon:"bx:file",class:"min-w-5 text-lg"}),s("span",we,f(r.name),1)]))]))),128))],2)):c("",!0)]),((M=e.uploadedFiles)!=null&&M.length||(F=Object.keys(e.uploadedFiles??{}))!=null&&F.length)&&!x.value?(t(),l("div",_e,[Array.isArray(e.uploadedFiles)?(t(!0),l(z,{key:0},U(e.uploadedFiles,r=>(t(),l("a",{class:"w-16",href:r.path,target:"_blank",key:r.id},[s("img",{class:"rounded-md",src:r.path,alt:"voucher"},null,8,Fe)],8,Se))),128)):(t(),l("a",{key:1,class:"w-16",href:e.uploadedFiles.path,target:"_blank"},[s("img",{class:"rounded-md",src:e.uploadedFiles.path,alt:"voucher"},null,8,je)],8,$e))])):c("",!0)],64)}}},Ve=Y(Ce,[["__scopeId","data-v-949fc3be"]]),ze={class:"grid max-h-[60vh] w-full grid-cols-1 gap-2 overflow-y-auto sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5"},Ae={class:"card flex items-center justify-center p-2"},Ie=["onClick"],Me={key:0,class:"h-full w-full object-contain",alt:"image"},Ne={key:1,controls:"",class:"h-full w-full"},Ue=["src"],De={key:2,controls:"",class:"h-full w-full"},Le=["src"],Pe=["src"],Be={key:3,class:"flex h-full flex-col items-center justify-center"},Ee={class:"text-sm font-semibold capitalize"},Re={key:0,class:"flex justify-end gap-2"},Ke={__name:"AssetModal",setup(e){le();const o=te();return(u,m)=>{const j=L("Icon"),b=H("lazy");return t(),P(Z,{"header-state":!0,"header-title":"Media Library",state:"assetModal","state-key":"assetModal","modal-size":"w-8/12 2xl:w-6/12"},{default:K(()=>{var v,x;return[s("div",ze,[s("div",Ae,[g(Ve,{classes:"h-32",modelValue:i(o).files,"onUpdate:modelValue":m[0]||(m[0]=n=>i(o).files=n),accept:((v=i(o).events)==null?void 0:v.load)??"image",percentage:i(o).assetUploadProgress,instantSubmit:i(o).assetSubmit,filePreviewPosition:"bottom"},null,8,["modelValue","accept","percentage","instantSubmit"])]),(t(!0),l(z,null,U(i(o).allAssets.data,(n,y)=>(t(),l("div",{key:n.id+y,onClick:C=>i(o).toggleSelect(n),class:$(["h-36 w-full cursor-pointer rounded-md border bg-slate-100 dark:bg-slate-900 dark:hover:bg-slate-800",{"border-2 border-primary-600 dark:border-primary-600":i(o).isSelected(n),"border-1 dark:border-slate-700":!i(o).isSelected(n)}])},[n.mime_type.includes("image")?N((t(),l("img",Me,null,512)),[[b,n.path]]):n.mime_type.includes("video")?(t(),l("video",Ne,[s("source",{src:n.path,type:"video/mp4"},null,8,Ue)])):n.mime_type.includes("audio")?(t(),l("audio",De,[s("source",{src:n.path,type:"audio/wav"},null,8,Le),s("source",{src:n.path,type:"audio/mp3"},null,8,Pe)])):(t(),l("div",Be,[g(j,{icon:"bx:file-blank",class:"h-12 w-12"}),s("p",Ee,f(n.original_name),1)]))],10,Ie))),128))]),g(ee,{"observer-condition":i(o).allAssets.loadMore,"after-intersection":()=>i(o).loadMoreAssets(),loader:i(o).allAssets.loading},null,8,["observer-condition","after-intersection","loader"]),i(o).events.multiple&&i(o).selectedAssets.length?(t(),l("div",Re,[i(o).events.caption!==void 0?N((t(),l("input",{key:0,type:"text","onUpdate:modelValue":m[1]||(m[1]=n=>i(o).events.caption=n),placeholder:"caption (optional)",class:"input w-full"},null,512)),[[Q,i(o).events.caption]]):c("",!0),i(o).events.button!==void 0||i(o).events.multiple?(t(),l("button",{key:1,onClick:m[2]||(m[2]=(...n)=>i(o).onSubmit&&i(o).onSubmit(...n)),type:"button",class:"btn btn-primary"},f(((x=i(o).events.button)==null?void 0:x.text)??"Attach"),1)):c("",!0)])):c("",!0)]}),_:1})}}};export{se as _,Ke as a};
