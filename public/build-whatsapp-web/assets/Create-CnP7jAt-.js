import{k as j,T as P,q as W,r as D,c as i,o as c,b as a,F as b,g as v,d as E,i as V,f as w,a as h,e as g,t as d,v as L,u as l,x as U,n as R,j as q,h as S}from"./app-B4kV47qU.js";import{_ as x}from"./InputField-DXo1g-Zb.js";import{_ as A}from"./SpinnerBtn-B3fjBeDL.js";import{_ as J}from"./UserLayout-DG2qUs8x.js";import G from"./TemplatePreview-BCVClSSu.js";import"./sharedComposable-VJJUONp6.js";import"./toastComposable-CvcyPmJb.js";import"./Modal-ChMy0A7y.js";import"./modalStore-BgORG3Nn.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ToastrContainer-Cfx6wOd2.js";import"./AssetModal-vtiWQmiY.js";import"./IntersectionObserver-DbdokySM.js";import"./assetStore-cDK0Afhq.js";const H={class:"card flex max-w-max flex-wrap gap-2 rounded-lg bg-gray-100 p-1 dark:bg-gray-800"},K=["onClick"],Q={class:"text-xs md:text-sm"},X={class:"mt-4 grid grid-cols-1 place-items-start gap-10 md:grid-cols-12"},Y={class:"card card-body md:col-span-9"},Z={class:"flex gap-3"},ee={class:"w-full"},te={class:"label mb-1 capitalize"},ae={value:"",disabled:"",selected:""},oe=["value"],se={key:0},le={class:"label mb-1 capitalize"},ne=["accept","onInput"],re={key:1},ce={class:"label mb-1 capitalize"},ie=["onUpdate:modelValue"],me={key:3},ue={class:"label mb-1 block capitalize"},de=["onUpdate:modelValue","placeholder"],pe=["onClick","disabled"],be={class:"flex justify-end"},_e={key:4},ve={key:5},he={class:"label mb-1 block capitalize"},ge={key:0},ye=["onClick"],xe=["onUpdate:modelValue","name"],ke={class:"flex items-center justify-between"},Ve={for:"save_as_template"},we={class:"ml-2"},Ue={class:"w-full md:col-span-3"},Se={class:"whatsapp-chat-body relative h-[35rem] rounded-xl border-2 border-dark-400 outline outline-4 outline-dark-500 dark:border-dark-800 dark:outline-dark-950"},fe={class:"absolute bottom-3 left-4 w-10/12 rounded-lg bg-white p-1 dark:bg-dark-700 xl:w-8/12"},Ee=Object.assign({layout:J},{__name:"Create",props:["platforms"],setup(f){const p=j("text"),t=P({name:"",type:"text",meta:{},save_as_template:!1,platform_id:"",receiver_number:""}),$=[{label:"Text Message",value:"text"},{label:"Text With Image",value:"image"},{label:"Text With Video",value:"video"},{label:"Audio Message",value:"audio"},{label:"Send Location",value:"location"},{label:"Poll Message",value:"poll"},{label:"Document Message",value:"document"}],C={text:{text:""},poll:{name:"",values:["",""],selectableCount:1},video:{video:null,caption:"",gifPlayback:!0},image:{image:null,caption:""},audio:{audio:null},location:{latitude:"",longitude:""},document:{document:null,caption:"",document_name:""}},k=n=>{t.type=n,t.meta=JSON.parse(JSON.stringify(C[n]))},T=()=>{t.post(route("user.whatsapp-web.send-message.store"),{onSuccess:()=>{t.reset(),p.value="text",k("text")}})};W(p,k),k(p.value);const M=(n,o)=>{const m=n.target.files[0];if(m){t.meta[o]=m;const s=URL.createObjectURL(m);o==="document"&&(t.meta.document_name=m.name),["video","image","audio"].includes(o)&&(t.meta[`${o}Url`]=s)}},_=(n,o)=>n==="values"?"array":["video","image","audio","document"].includes(n)?"file":typeof o=="boolean"?"checkbox":typeof o=="number"?"number":["latitude","longitude","name","caption"].includes(n)?"input":n==="text"?"textarea":"input",F=()=>{t.meta.values.push("")},O=n=>{t.meta.values.splice(n,1)},B=(n,o)=>{const m=document.querySelector(`textarea[name="meta.${n}"]`);if(!m)return;const s=m.selectionStart,e=m.selectionEnd,r=t.meta[n].substring(s,e),u=r.startsWith(o)&&r.endsWith(o),y=u?r.slice(o.length,-o.length):o+r+o;t.meta[n]=t.meta[n].substring(0,s)+y+t.meta[n].substring(e);const N=s+(u?-o.length:o.length),z=e+(u?-o.length:o.length);m.setSelectionRange(N,z)},I=[{label:"Italic",symbol:"_"},{label:"Monospace",symbol:"```"},{label:"Strike",symbol:"~"},{label:"Bold",symbol:"*"}];return(n,o)=>{const m=D("Icon");return c(),i(b,null,[a("div",H,[(c(),i(b,null,v($,s=>a("button",{key:s.value,class:R(["btn-xs flex-1 whitespace-nowrap rounded-md px-8 py-2 hover:bg-primary-100 dark:hover:bg-primary-700/50 md:flex-initial",{"bg-primary-600 text-white hover:bg-primary-700 dark:bg-primary-700 dark:hover:bg-primary-800":s.value===p.value,"bg-white text-gray-700 dark:bg-gray-700 dark:text-gray-200":s.value!==p.value}]),onClick:e=>p.value=s.value},[a("span",Q,d(s.label),1)],10,K)),64))]),a("div",X,[a("div",Y,[a("form",{onSubmit:E(T,["prevent"]),class:"space-y-2"},[a("div",Z,[a("div",ee,[a("label",te,d(n.trans("Select Device")),1),g(a("select",{name:"platform_id","onUpdate:modelValue":o[0]||(o[0]=s=>l(t).platform_id=s),class:"select"},[a("option",ae,d(n.trans("Select Platform")),1),(c(!0),i(b,null,v(f.platforms,s=>(c(),i("option",{key:s.id,value:s.uuid},d(s.name),9,oe))),128))],512),[[L,l(t).platform_id]])]),h(x,{modelValue:l(t).receiver_number,"onUpdate:modelValue":o[1]||(o[1]=s=>l(t).receiver_number=s),label:"Message To (Receiver)"},null,8,["modelValue"])]),(c(!0),i(b,null,v(l(t).meta,(s,e)=>(c(),i(b,{key:e},[_(e,s)==="file"?(c(),i("div",se,[a("label",le,d(e),1),a("input",{type:"file",accept:e==="document"?"*/*":`${e}/*`,onInput:r=>M(r,e),class:"input"},null,40,ne)])):_(e,s)==="checkbox"?(c(),i("div",re,[a("label",ce,[g(a("input",{type:"checkbox","onUpdate:modelValue":r=>l(t).meta[e]=r,class:"checkbox mr-2"},null,8,ie),[[U,l(t).meta[e]]]),q(" "+d(e),1)])])):_(e,s)==="number"?(c(),V(x,{key:2,modelValue:l(t).meta[e],"onUpdate:modelValue":r=>l(t).meta[e]=r,label:e.charAt(0).toUpperCase()+e.slice(1),type:"number",step:"any"},null,8,["modelValue","onUpdate:modelValue","label"])):_(e,s)==="array"?(c(),i("div",me,[a("label",ue,d(e),1),(c(!0),i(b,null,v(l(t).meta[e],(r,u)=>(c(),i("div",{key:u,class:"mb-2 flex items-center"},[g(a("input",{"onUpdate:modelValue":y=>l(t).meta[e][u]=y,type:"text",placeholder:`Option ${u+1}`,class:"input mr-2"},null,8,de),[[S,l(t).meta[e][u]]]),a("button",{type:"button",onClick:y=>O(u),class:"btn btn-danger py-2",disabled:l(t).meta[e].length<=2},[h(m,{icon:"bx:trash",class:"text-lg"})],8,pe)]))),128)),a("div",be,[a("button",{type:"button",onClick:F,class:"btn btn-primary py-1"},[h(m,{icon:"bx:plus"}),o[4]||(o[4]=a("span",null,"Option",-1))])])])):_(e,s)==="input"?(c(),i("div",_e,[e!==`${p.value}Url`&&e!==`${p.value}_name`?(c(),V(x,{key:0,modelValue:l(t).meta[e],"onUpdate:modelValue":r=>l(t).meta[e]=r,label:e,placeholder:`Enter ${e}`},null,8,["modelValue","onUpdate:modelValue","label","placeholder"])):w("",!0)])):(c(),i("div",ve,[a("label",he,d(e),1),e==="text"?(c(),i("div",ge,[(c(),i(b,null,v(I,r=>a("button",{key:r.label,type:"button",class:"btn btn-outline-primary btn-xs mr-2",onClick:u=>B(e,r.symbol)},d(r.label),9,ye)),64))])):w("",!0),g(a("textarea",{"onUpdate:modelValue":r=>l(t).meta[e]=r,name:`meta.${e}`,class:"textarea mt-2"},null,8,xe),[[S,l(t).meta[e]]])]))],64))),128)),l(t).save_as_template?(c(),V(x,{key:0,modelValue:l(t).name,"onUpdate:modelValue":o[2]||(o[2]=s=>l(t).name=s),label:"Name"},null,8,["modelValue"])):w("",!0),a("div",ke,[a("label",Ve,[g(a("input",{id:"save_as_template","onUpdate:modelValue":o[3]||(o[3]=s=>l(t).save_as_template=s),type:"checkbox",class:"checkbox"},null,512),[[U,l(t).save_as_template]]),a("span",we,d(n.trans("Save as template?")),1)]),h(A,{"btn-text":"Submit",type:"submit",class:"btn btn-primary mt-4",processing:l(t).processing},null,8,["processing"])])],32)]),a("div",Ue,[a("div",Se,[a("div",fe,[h(G,{template:l(t)},null,8,["template"])])])])])],64)}}});export{Ee as default};
