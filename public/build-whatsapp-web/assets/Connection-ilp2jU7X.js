import{c as d,f as m,o as r,b as e,t as a,X as l,k as C,l as z,p as U,U as X,q as J,a as n,u as s,F as B,g as K,i as k,N as u,B as Z,j as q,w as T,aa as M,s as D}from"./app-B4kV47qU.js";import{H as W}from"./IntersectionObserver-DbdokySM.js";import{_ as ee}from"./UserLayout-DG2qUs8x.js";import{u as te}from"./modalStore-BgORG3Nn.js";import{t as se}from"./toastComposable-CvcyPmJb.js";import{_ as ae}from"./Modal-ChMy0A7y.js";import{m as oe}from"./sharedComposable-VJJUONp6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ToastrContainer-Cfx6wOd2.js";import"./AssetModal-vtiWQmiY.js";import"./assetStore-cDK0Afhq.js";const le={key:0,class:"mb-3 mt-8 flex flex-col items-center justify-center"},re=["src"],ne={class:"font-semibold text-gray-500 dark:text-gray-300"},H={__name:"ErrorWarning",props:{errorCode:{type:Number,default:null}},setup(f){const i={500:{message:"Server Error",image:"/assets/images/server-warning.png"}};return(h,R)=>{var p,v;return f.errorCode&&i[f.errorCode]?(r(),d("div",le,[e("img",{src:(p=i[f.errorCode])==null?void 0:p.image,class:"mb-1 h-20",alt:""},null,8,re),e("p",ne,a((v=i[f.errorCode])==null?void 0:v.message),1)])):m("",!0)}}},de={key:0},ie={colspan:"10"},ce={class:"flex flex-col items-center justify-center mt-5 mb-8"},ue={class:"text-gray-500"},me={key:1,class:"flex flex-col items-center justify-center mt-5 mb-8"},he={class:"text-gray-500"},pe={__name:"NoDataFound",props:{forTable:{type:[Boolean,String],default:!1}},setup(f){return(i,h)=>f.forTable?(r(),d("tbody",de,[e("tr",null,[e("td",ie,[e("div",ce,[h[0]||(h[0]=e("img",{src:"/assets/images/no-data.svg",class:"h-16 my-3",alt:""},null,-1)),e("p",ue,a(i.trans("No data found")),1)])])])])):(r(),d("div",me,[h[1]||(h[1]=e("img",{src:"/assets/images/no-data.svg",class:"h-16 my-3",alt:""},null,-1)),e("p",he,a(i.trans("No data found")),1)]))}},ge={class:"grid grid-cols-1 place-items-start gap-6 lg:grid-cols-12"},fe={class:"card card-body shadow-lg transition-all hover:shadow-xl lg:col-span-4"},ve={class:"mb-4 text-xl font-bold text-primary-600"},xe={class:"relative"},ye={class:"relative z-10 flex flex-col"},be={class:"mr-4 shrink-0"},_e={class:"flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-br from-primary-600 to-primary-500 text-white shadow-md transition-all hover:shadow-lg"},we={class:"pt-2"},Ce={class:"mb-1 text-xs font-bold text-primary-500"},ke={class:"text-sm font-medium"},qe={class:"card card-body shadow-lg transition-all hover:shadow-xl lg:col-span-8"},Te={class:"mb-6 text-center text-xl font-bold text-primary-600"},Le={key:0,class:"flex flex-col items-center justify-center"},Se={key:1,class:"relative my-8 h-[200px] w-[200px] overflow-hidden rounded-lg shadow-lg transition-all hover:shadow-xl"},Ie=["src"],$e={class:"absolute left-1/2 top-1/2 flex h-16 w-16 -translate-x-1/2 -translate-y-1/2 items-center justify-center rounded-full bg-white shadow-lg"},je={key:1,class:"mx-auto w-4/5 max-w-xs p-1 shadow-inner"},Me={class:"mt-2 text-center text-xs font-medium text-gray-500 dark:text-gray-400"},De={class:"mt-8 flex flex-col items-center justify-center gap-2 pb-6"},Ne={key:0,class:"my-4 text-sm text-gray-500"},Qe={class:"flex flex-wrap items-center justify-center gap-3"},Be={key:3,class:"mt-6 flex flex-col items-center"},Re={class:"mb-4 flex justify-center"},Ee={class:"rounded-lg border border-primary-500 bg-white px-8 py-2 shadow-lg dark:bg-gray-800"},Pe={class:"text-center text-2xl font-bold tracking-widest"},Ae={class:"mt-2 max-w-sm rounded-lg bg-yellow-50 p-4 text-center dark:bg-yellow-900/30"},We={class:"text-sm font-medium text-yellow-800 dark:text-yellow-200"},He={class:"mt-1 text-xs text-yellow-700 dark:text-yellow-300"},Oe={key:1,class:"flex flex-col items-center"},Ve={class:"relative my-6"},Fe=["src"],Ge={class:"mb-4 text-2xl font-bold text-green-600 dark:text-green-400"},Ye={class:"mb-8 text-center text-gray-600 dark:text-gray-300"},ze={class:"grid w-full grid-cols-2 gap-4"},Ue={class:"flex flex-col items-center p-6 text-center"},Xe={class:"mb-4 rounded-full bg-yellow-100 p-4 dark:bg-yellow-900/30"},Je={class:"mb-2 text-2xl font-bold text-gray-800 dark:text-gray-100"},Ke={class:"mb-6 text-gray-600 dark:text-gray-300"},Ze={class:"flex gap-3"},O=12e4,et=5e3,mt=Object.assign({layout:ee},{__name:"Connection",props:["platform"],setup(f){const i=te(),h=f,R=[{icon:"bx:bxl-whatsapp",text:l("Open WhatsApp on your phone"),image:"/assets/images/scan-demo.gif"},{icon:"bx:cog",text:l("Tap Menu or Settings and select Linked Devices"),image:"/assets/images/scan-demo.gif"},{icon:"bx:like",text:l("Tap on Link a Device"),image:"/assets/images/scan-demo.gif"},{icon:"material-symbols-light:qr-code-2-rounded",text:l("Point your phone to this screen to capture the code"),image:"/assets/images/scan-demo.gif"}],p=C(!1),v=C(0),g=C(null),b=C(!1),t=C({qrCode:null,code:null,authType:"qr_code",qrCodeLoader:!0,codeLoader:!1});let L=null,S=null,x=null;const I=()=>{t.value.qrCodeLoader=!0,g.value=null,D.get(route("user.whatsapp-web.api.platforms.connection",{uuid:h.platform.uuid})).then(o=>{t.value.qrCodeLoader=!1,t.value.qrCode=o.data,N()}).catch(o=>{t.value.qrCodeLoader=!1,g.value=o.status,console.log(o)})},E=()=>{y(),t.value.authType="code",t.value.codeLoader=!0,g.value=null,D.get(route("user.whatsapp-web.api.platforms.code",{uuid:h.platform.uuid})).then(o=>{t.value.codeLoader=!1,t.value.code=o.data.code,N()}).catch(o=>{t.value.codeLoader=!1,t.value.code=null,g.value=o.status})},N=()=>{x&&clearInterval(x),x=setInterval(()=>{b.value||p.value||D.get(route("user.whatsapp-web.api.platforms.check-status"),{params:{uuid:h.platform.uuid}}).then(o=>{var c;((c=o.data)==null?void 0:c.status)==="connected"?(p.value=!0,b.value=!0,t.value.qrCodeLoader=!1,clearInterval(x),y()):(p.value=!1,!t.value.qrCodeLoader&&!t.value.qrCode&&!b.value&&t.value.authType==="qr_code"&&(I(),w()))}).catch(o=>{t.value.qrCodeLoader=!1,g.value=o.status,o.status===500&&clearInterval(x)})},et)},_=()=>{L&&(clearInterval(L),L=null)},w=()=>{y(),v.value=0;const o=Date.now();L=setInterval(()=>{const $=Date.now()-o;v.value=Math.max(100-$/O*100,0),v.value<=0&&_()},200),S=setTimeout(()=>{y(),!i.getState("qrCodeModal")&&t.value.authType==="qr_code"&&!p.value&&(i.open("qrCodeModal"),t.value.qrCodeLoader=!1,t.value.qrCode=null,_())},O)},V=z(()=>`${v.value}%`),y=()=>{S&&(clearTimeout(S),S=null)};U(()=>{var o;((o=h.platform)==null?void 0:o.status)==="connected"?N():I(),w()}),X(()=>{y(),clearInterval(x),_()}),J(()=>i.getState("qrCodeModal"),o=>{o?(b.value=!0,y()):w()});const F=()=>{oe.initCallback(()=>{D.delete(route("user.whatsapp-web.api.platforms.destroy",h.platform.uuid)).then(o=>{var c;((c=o.data)==null?void 0:c.status)===!0&&(se.success("Session revoked successfully"),p.value=!1,b.value=!1,_(),I(),w())})})},Q=()=>{p.value=!1,b.value=!0,_(),clearInterval(x),I(),y(),w(),i.close()},G=()=>{t.value.authType=t.value.authType==="qr_code"?"code":"qr_code",t.value.authType==="qr_code"&&(_(),t.value.code=null,Q()),t.value.authType==="code"&&(t.value.qrCode=null,E())},Y=()=>localStorage.getItem("theme")==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches;return(o,c)=>{var $,P;return r(),d(B,null,[e("div",ge,[e("div",fe,[e("h2",ve,a(s(l)("How to Scan QR Code")),1),c[2]||(c[2]=e("div",{class:"relative mb-6 overflow-hidden rounded-lg"},[e("img",{src:"/assets/images/scan-demo.gif",alt:"scan-demo.gif",class:"w-full rounded-lg shadow-md transition-transform hover:scale-[1.02]"})],-1)),e("div",xe,[c[1]||(c[1]=e("div",{class:"absolute left-6 top-6 hidden h-[calc(100%-12px)] w-0.5 bg-gradient-to-b from-primary-500 to-primary-400 shadow-md md:block"},null,-1)),e("div",ye,[(r(),d(B,null,K(R,(j,A)=>e("div",{key:A,class:"relative flex h-24 items-start p-1 transition-all hover:bg-gray-50 dark:hover:bg-gray-800/30"},[e("div",be,[e("div",_e,[n(s(u),{icon:j.icon,class:"text-xl"},null,8,["icon"])])]),e("div",we,[e("p",Ce,a(s(l)("STEP"))+" "+a(A+1),1),e("span",ke,a(j.text),1)])])),64))])])]),e("div",qe,[p.value?(r(),d("div",Oe,[e("div",Ve,[e("img",{class:"w-60",src:`/assets/images/${Y()?"":"dark-"}confetti.gif`,alt:"confetti"},null,8,Fe)]),e("h2",Ge,a(s(l)("Connected Successfully")),1),e("p",Ye,a(s(l)("Your WhatsApp account is now linked. You can start using the services.")),1),e("div",ze,[n(s(M),{class:"btn flex items-center justify-center gap-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white shadow-md transition-all hover:-translate-y-0.5 hover:shadow-lg",href:o.route("user.whatsapp-web.platforms.index")},{default:T(()=>[n(s(u),{icon:"bx:list-ul",class:"text-lg"}),e("span",null,a(s(l)("Chat List")),1)]),_:1},8,["href"]),n(s(M),{class:"btn flex items-center justify-center gap-2 bg-gradient-to-r from-green-600 to-green-500 text-white shadow-md transition-all hover:-translate-y-0.5 hover:shadow-lg",href:o.route("user.whatsapp-web.groups.index")},{default:T(()=>[n(s(u),{icon:"bx:group",class:"text-lg"}),e("span",null,a(s(l)("Group List")),1)]),_:1},8,["href"]),n(s(M),{class:"btn flex items-center justify-center gap-2 bg-gradient-to-r from-purple-600 to-purple-500 text-white shadow-md transition-all hover:-translate-y-0.5 hover:shadow-lg",href:o.route("user.whatsapp-web.send-message.create")},{default:T(()=>[n(s(u),{icon:"bx:send",class:"text-lg"}),e("span",null,a(s(l)("Send Message")),1)]),_:1},8,["href"]),n(s(M),{class:"btn flex items-center justify-center gap-2 bg-gradient-to-r from-amber-600 to-amber-500 text-white shadow-md transition-all hover:-translate-y-0.5 hover:shadow-lg",href:o.route("user.whatsapp-web.send-bulk-message.index")},{default:T(()=>[n(s(u),{icon:"bx:rocket",class:"text-lg"}),e("span",null,a(s(l)("Bulk Message")),1)]),_:1},8,["href"])]),e("button",{class:"btn mt-6 flex w-full items-center justify-center gap-2 bg-gradient-to-r from-red-600 to-red-500 text-white shadow-md transition-all hover:shadow-lg",onClick:F},[n(s(u),{icon:"bx:log-out",class:"text-lg"}),e("span",null,a(s(l)("Disconnect Device")),1)])])):(r(),d(B,{key:0},[e("h2",Te,a(s(l)(`${t.value.authType==="qr_code"?"Scan QR Code":"Enter Code"} On Your WhatsApp Mobile App`)),1),t.value.authType==="qr_code"?(r(),d("div",Le,[t.value.qrCodeLoader?(r(),k(W,{key:0,class:"mt-8 scale-150"})):m("",!0),!t.value.qrCodeLoader&&t.value.qrCode?(r(),d("div",Se,[e("img",{src:(P=($=t.value)==null?void 0:$.qrCode)==null?void 0:P.qr,alt:"qr-code",class:"h-full w-full"},null,8,Ie),e("div",$e,[n(s(u),{icon:"bx:bxl-whatsapp",class:"text-3xl text-green-500"})])])):!t.value.qrCodeLoader&&!t.value.qrCode&&!g.value?(r(),k(pe,{key:2})):m("",!0),g.value?(r(),k(H,{key:3,"error-code":g.value},null,8,["error-code"])):m("",!0)])):m("",!0),!t.value.qrCodeLoader&&t.value.qrCode&&t.value.authType==="qr_code"?(r(),d("div",je,[e("div",{class:"h-2 rounded-full bg-gradient-to-r from-primary-600 to-primary-400 transition-all duration-300",style:Z({width:V.value})},null,4),e("p",Me,a(s(l)("QR Code expires in"))+" "+a(Math.ceil(v.value*1.2))+" "+a(s(l)("seconds")),1)])):m("",!0),e("div",De,[t.value.authType==="qr_code"?(r(),d("p",Ne,a(s(l)("Having trouble scanning?")),1)):m("",!0),e("div",Qe,[e("button",{class:"btn flex items-center gap-2 bg-gradient-to-r from-primary-600 to-primary-500 text-white shadow-md transition-all hover:shadow-lg",type:"button",onClick:G},[n(s(u),{icon:t.value.authType==="qr_code"?"bx:mobile":"material-symbols-light:qr-code-2-rounded",class:"text-lg"},null,8,["icon"]),q(" "+a(s(l)(`Connect with ${t.value.authType==="qr_code"?"phone number":"QR code"} instead`)),1)]),t.value.authType==="qr_code"?(r(),d("button",{key:0,class:"btn flex items-center gap-2 bg-blue-500 text-white shadow-md transition-all hover:shadow-lg",onClick:Q,type:"button"},[n(s(u),{icon:"bx:refresh",class:"text-lg"}),q(" "+a(s(l)("Refresh QR Code")),1)])):m("",!0),t.value.authType==="code"?(r(),d("button",{key:1,class:"btn flex items-center gap-2 bg-blue-500 text-white shadow-md transition-all hover:shadow-lg",onClick:E,type:"button"},[n(s(u),{icon:"bx:refresh",class:"text-lg"}),q(" "+a(s(l)("Generate New Code")),1)])):m("",!0)]),t.value.codeLoader?(r(),k(W,{key:1,class:"mt-6 scale-150"})):m("",!0),g.value&&t.value.authType==="code"&&!t.value.qrCodeLoader&&!t.value.codeLoader?(r(),k(H,{key:2,"error-code":g.value},null,8,["error-code"])):m("",!0),t.value.code&&!t.value.codeLoader?(r(),d("div",Be,[e("div",Re,[e("div",Ee,[e("p",Pe,a(t.value.code),1)])]),e("div",Ae,[e("p",We,a(s(l)("Enter this code on your WhatsApp")),1),e("p",He,a(s(l)("Never enter a code if you didn't request it.")),1)])])):m("",!0)])],64))])]),n(ae,{state:"qrCodeModal"},{default:T(()=>[e("div",Ue,[e("div",Xe,[n(s(u),{icon:"bi:info-circle",class:"h-16 w-16 text-yellow-500"})]),e("h2",Je,a(s(l)("QR Code Expired")),1),e("p",Ke,a(s(l)("The QR code has expired. Please refresh to generate a new one.")),1),e("div",Ze,[e("button",{class:"btn flex items-center gap-2 bg-primary-600 text-white shadow-md transition-all hover:bg-primary-700",type:"button",onClick:Q},[n(s(u),{icon:"bx:refresh",class:"text-lg"}),q(" "+a(s(l)("Generate New QR")),1)]),e("button",{class:"btn flex items-center gap-2 bg-gray-500 text-white shadow-md transition-all hover:bg-gray-600",onClick:c[0]||(c[0]=(...j)=>s(i).close&&s(i).close(...j))},[n(s(u),{icon:"bx:x",class:"text-lg"}),q(" "+a(s(l)("Close")),1)])])])]),_:1})],64)}}});export{mt as default};
