import{d as E,j as G,I as L,m as f,s as R,k as b,r as Y,c as n,o as i,a as e,b as x,h as J,t as s,F as _,g as A,u as r,J as W,w as Z,l as g,v as S,n as H,Z as j,x as K,i as C,_ as Q,N as F,E as N}from"./app-CHoD4jNo.js";import{_ as X}from"./UserLayout-T1Rud9jK.js";import{m as U}from"./vue3-apexcharts-ClrHZ1o3.js";import{h as V}from"./moment-BAtM24Ew.js";import"./AssetModal-Dh3z8yqV.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./InputFieldError-DJP3I4Ws.js";import"./ToastrContainer-DreH4TsU.js";const ee={class:"grid grid-cols-12 gap-6"},te={class:"card card-body col-span-full lg:col-span-7 2xl:col-span-8"},se={class:"chart-filter-area flex justify-between"},ae={class:"flex items-center gap-2"},oe=["selected","value"],le={class:"card card-body col-span-full lg:col-span-5 2xl:col-span-4"},ne={class:"me-3 font-bold"},ie={class:"flex h-full flex-col justify-evenly"},re={class:"grid grid-cols-2 place-items-center gap-1"},de={class:"mt-2"},ue={class:"mb-3 space-x-1"},ce={class:"text-lg font-bold"},me={class:"text-sm"},pe={class:"flex gap-2"},he={class:"font-bold"},ve={class:"mb-1 mt-2 flex justify-between gap-3"},fe={class:"flex items-center gap-1"},be={class:"flex items-center gap-1"},_e={class:"flex items-center"},ge={class:"relative w-full"},ye={class:"mt-5 flex justify-between"},xe={class:"mb-3 text-center"},Ce={class:"fw-bold mt-2 text-left"},we={class:"my-8 flex flex-wrap gap-2 px-3"},ke=["onClick"],Ae=["src"],Se=["id"],Me=["onSubmit"],De={class:"table-responsive"},Be={class:"table-borderless table text-sm"},Ie={key:0,class:"border"},Oe={class:"border border-black p-2"},je={class:"text-center"},Fe={key:0,class:"table-borderless mt-2 table"},Ne={class:"fw-500 text-sm"},Ue={class:"text-sm"},Ve={key:1,class:"form-group mt-2"},Pe={class:"fw-500 text-fs-sm my-2"},Te={class:"form-group mt-1"},$e={class:"fw-500 text-fs-sm my-2"},qe={class:"form-group"},ze={class:"fw-500 text-fs-sm my-2"},Ee=["disabled"],Ge=E({layout:X}),Xe=Object.assign(Ge,{__name:"Index",props:["credits","costChartData","activeChartFilterBtn","credit_fee","gateways","totalCostAmount","availableCreditAmount","spendCreditAmount"],setup(d){var O;const M=G(),{getState:Le}=L(M),l=d,w=f(()=>{let t=l.availableCreditAmount+l.spendCreditAmount;return{available:Math.round(l.availableCreditAmount/t*100),spend:Math.round(l.spendCreditAmount/t*100)}}),P=["day","week","month","year"],D=f(()=>({series:[{name:"costs",data:l.costChartData.map(t=>t.credit)}],chartOptions:{colors:["#69ae84"],chart:{height:350,type:"bar",toolbar:{show:!1}},plotOptions:{bar:{horizontal:!1,columnWidth:"10px",endingShape:"rounded"}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},yaxis:{show:!1,opposite:!0,labels:{formatter:function(t){return t.toFixed(0)}}},xaxis:{type:"string",categories:l.costChartData.map(t=>t.date)}}})),B=f(()=>({series:[l.availableCreditAmount,l.spendCreditAmount],chartOptions:{colors:["#22c55e","#f87171"],labels:["Available","Used"],chart:{width:210,type:"donut"},dataLabels:{enabled:!1},responsive:[{breakpoint:480,options:{chart:{width:200},legend:{show:!1}}}],legend:{show:!1}}})),{formatCurrency:p,authUser:T}=R(),h=b(((O=l.gateways[0])==null?void 0:O.id)||0),v=b(null),I=b(l.credit_fee),y=f(()=>v.value/I.value),k=b(!1),u=b({image:null,comment:"",phone:T.value.phone}),m=f(()=>l.gateways.find(t=>t.id===h.value)),$=t=>{if(m.value.min_amount>y.value){N.danger("The minimum transaction amount is "+p(m.value.min_amount));return}if(m.value.max_amount!=-1&&m.value.max_amount<y.value){N.danger("The maximum transaction amount is "+p(m.value.max_amount));return}k.value=!0,F.post(route("credit.pay"),{gateway_id:t,total:y.value,credits:v.value,manualPayment:m.value.is_auto==0?u.value:null,phone:u.value.phone},{onFinish:()=>{v.value=0,k.value=!1}})},q=t=>{F.get(t)};return(t,o)=>{const z=Y("Icon");return i(),n(_,null,[e("div",ee,[e("div",te,[e("div",se,[e("h6",ae,[o[6]||(o[6]=e("i",{class:"bx bx-credit-card text-2xl"},null,-1)),J(" "+s(t.trans("Costs"))+": "+s(d.totalCostAmount),1)]),e("select",{class:"select w-36 capitalize",onInput:o[0]||(o[0]=a=>q(a.target.value))},[(i(),n(_,null,A(P,a=>e("option",{key:a,selected:a==d.activeChartFilterBtn,value:t.route("user.credits.index",{scope:a})},s(a),9,oe)),64))],32)]),x(r(U),{type:"bar",height:"350",options:D.value.chartOptions,series:D.value.series},null,8,["options","series"])]),e("div",le,[e("span",ne,s(t.trans("Monthly Bill")),1),e("span",null,s(r(V)().startOf("month").format("DD MMM"))+" - "+s(r(V)().endOf("month").format("DD MMM")),1),e("div",ie,[e("div",re,[x(r(U),{type:"donut",height:"210",width:"210",options:B.value.chartOptions,series:B.value.series},null,8,["options","series"]),e("div",de,[e("div",ue,[e("span",ce,s(d.spendCreditAmount),1),e("span",me,"/ "+s(d.availableCreditAmount)+" "+s(t.trans("limit")),1)]),e("button",{type:"button",onClick:o[1]||(o[1]=a=>r(M).open("addCredits")),class:"btn btn-primary"},[x(z,{icon:"bx:plus"}),e("span",null,s(t.trans("Increase limit‍")),1)])])]),e("div",null,[e("div",pe,[e("div",he,s(t.trans("Credit Usage")),1)]),e("div",ve,[e("div",fe,[o[7]||(o[7]=e("span",{class:"h-4 w-4 rounded-sm bg-green-500"},null,-1)),e("span",null,s(t.trans("Available")),1)]),e("div",be,[o[8]||(o[8]=e("div",{class:"h-4 w-4 rounded-sm bg-red-400"},null,-1)),e("span",null,s(t.trans("Used")),1)])]),e("div",_e,[e("div",ge,[o[9]||(o[9]=e("div",{class:"absolute left-0 h-4 w-full rounded bg-red-400"},null,-1)),e("div",{class:"absolute left-0 h-4 rounded bg-green-500",style:W({width:w.value.available+"%"})},null,4)])]),e("div",ye,[e("span",null,s(w.value.available)+" % ",1),e("span",null,s(w.value.spend)+" % ",1)])])])])]),x(Q,{state:"addCredits","header-state":!0,"header-title":"Buy Credits"},{default:Z(()=>[e("p",xe,s(I.value)+" "+s(t.trans("Credits"))+" = "+s(r(p)(1)),1),g(e("input",{class:"input",step:"5",type:"number","onUpdate:modelValue":o[2]||(o[2]=a=>v.value=a),placeholder:"Enter Credit amount"},null,512),[[S,v.value,void 0,{number:!0}]]),e("p",Ce,s(t.trans("Total:"))+" "+s(r(p)(y.value||0)),1),e("div",we,[(i(!0),n(_,null,A(d.gateways,a=>(i(),n("button",{key:a.id,class:H(["relative flex flex-1 items-center justify-center rounded-lg p-4",{"border bg-slate-50":h.value==a.id}]),onClick:c=>h.value=a.id},[g(e("div",null,o[10]||(o[10]=[e("i",{class:"bx bx-check absolute right-[-10px] top-[-10px] rounded-full bg-primary-600 p-1 text-white"},null,-1)]),512),[[j,h.value==a.id]]),e("img",{src:a.logo,class:"max-w-24"},null,8,Ae)],10,ke))),128))]),(i(!0),n(_,null,A(d.gateways,a=>g((i(),n("div",{key:a.id,class:"",id:"gateway-form"+a.id},[e("form",{method:"post",onSubmit:K(c=>$(a.id),["prevent"]),enctype:"multipart/form-data"},[e("div",De,[e("table",Be,[a.charge!=0?(i(),n("tr",Ie,[e("td",Oe,s(t.trans("Gateway Charge: ")),1),e("td",je,s(r(p)(a.charge)),1)])):C("",!0)]),a.comment!=null?(i(),n("table",Fe,[e("tr",null,[e("td",Ne,s(t.trans("Payment Instruction: ")),1)]),e("tr",null,[e("td",Ue,s(a.comment),1)])])):C("",!0),a.phone_required==1?(i(),n("div",Ve,[e("label",Pe,s(t.trans("Your phone number")),1),g(e("input",{type:"number",name:"phone",placeholder:"Your phone number",class:"input",required:"","onUpdate:modelValue":o[3]||(o[3]=c=>u.value.phone=c)},null,512),[[S,u.value.phone]])])):C("",!0),a.is_auto==0?(i(),n(_,{key:2},[e("div",Te,[e("label",$e,s(t.trans("Submit your payment proof")),1),e("input",{onInput:o[4]||(o[4]=c=>{u.value.image=c.target.files[0]}),type:"file",name:"image",class:"input",required:"",accept:"image/*"},null,32)]),e("div",qe,[e("label",ze,s(t.trans("Comment")),1),g(e("textarea",{"onUpdate:modelValue":o[5]||(o[5]=c=>u.value.comment=c),class:"input",required:"",name:"comment",placeholder:"comment",maxlength:"500"},null,512),[[S,u.value.comment]])])],64)):C("",!0)]),e("button",{disabled:k.value,type:"submit",class:"btn btn-primary mt-4 w-full py-2 text-lg"},s(t.trans("Pay Now")),9,Ee)],40,Me)],8,Se)),[[j,h.value===a.id]])),128))]),_:1})],64)}}});export{Xe as default};
