import{aA as E,m as M,r as C,e as S,o as v,w as q,c as k,F as D,g as $,a as e,b,h as N,t as d,u as l,E as g,d as L,q as T,x as V,i as A,l as I,v as x,A as j,H as R}from"./app-CHoD4jNo.js";import{_ as F}from"./AdminLayout-Ddg1XhLg.js";import{l as K}from"./vue-draggable-plus-BXHDRgZL.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AssetModal-Dh3z8yqV.js";import"./InputFieldError-DJP3I4Ws.js";import"./ToastrContainer-DreH4TsU.js";const t=E({contents:[],contentId:null,isEdit:!1,newItem:{id:null,text:"",icon:"",href:"",permission:"",target:"_self",children:[]},addNewItem(){if(this.newItem.text){this.newItem.id=Math.floor(Math.random()*Date.now()).toString(36);const n={...this.newItem};this.contents.push(n),this.resetItem()}},editItem(){this.isEdit=!0;const n=this.findItemById(this.contents,this.contentId);n&&(this.newItem={...n})},updateItem(){const n=this.findItemById(this.contents,this.newItem.id);n&&this.newItem.text&&(Object.assign(n,this.newItem),this.resetItem(),this.isEdit=!1)},removeItemById(n,c){for(let a=0;a<n.length;a++){if(n[a].id===c){n.splice(a,1);return}n[a].children&&n[a].children.length>0&&this.removeItemById(n[a].children,c)}},removeItem(){this.removeItemById(this.contents,this.contentId)},resetItem(){setTimeout(()=>{this.newItem={id:null,text:"",icon:"",href:"",permission:"",target:"_self",children:[]}},500)},findItemById(n,c){for(const a of n){if(a.id===c)return a;if(a.children&&a.children.length>0){const s=this.findItemById(a.children,c);if(s)return s}}return null}}),P={class:"flex items-center justify-between rounded border p-2 dark:border-gray-600"},H={class:"cursor-move"},Y=["onClick"],z=["onClick"],G=1,J={__name:"NestedDraggableSidebar",props:{modelValue:{required:!0},level:{type:Number,default:0}},emits:["update:modelValue"],setup(n,{emit:c}){const a=n,s=c,o=M({get:()=>a.modelValue,set:u=>s("update:modelValue",u)}),_=(u,p)=>{if(!p.deletable)return g.danger("You can not delete this item");t.contentId=u,t.removeItem()},i=u=>{t.contentId=u,t.editItem()},U=u=>(u.to.dataset.level?parseInt(u.to.dataset.level):0)>G?(g.warning("Cannot move this item to the selected location due to nesting restrictions."),!1):!0,B=u=>{const p=u.data;if(p.children&&p.children.length>0){const h=Array.from(p.children),r=[];h.forEach(f=>{r.push(f),t.contentId=f.id,t.removeItem()}),r.forEach(f=>{t.contents.push(f)}),g.warning("Remaining links added at the end")}const y=h=>h.map(r=>(r.children?r.children=y(r.children):r.children=[],r)),m=h=>h.map(r=>(r.children&&(r.children=r.children.map(f=>(f.children&&delete f.children,f))),r));return t.contents=y(t.contents),t.contents=m(t.contents),!0};return(u,p)=>{const w=C("Icon"),y=C("NestedDraggableSidebar",!0);return v(),S(l(K),{class:"drag-area",tag:"ul",modelValue:o.value,"onUpdate:modelValue":p[0]||(p[0]=m=>o.value=m),group:"g1",onMove:U,onEnd:B,"data-level":n.level},{default:q(()=>[(v(!0),k(D,null,$(n.modelValue,m=>(v(),k("li",{key:m.id},[e("div",P,[e("p",H,[b(w,{class:"mb-px inline text-lg",icon:"tdesign:drag-move"}),N(" "+d(m.text),1)]),e("div",null,[e("button",{class:"btn p-1.5",onClick:h=>i(m.id)},[b(w,{class:"text-lg",icon:"fe:pencil"})],8,Y),e("button",{class:"btn p-1.5",onClick:h=>_(m.id,m)},[b(w,{class:"text-lg",icon:"fe:trash"})],8,z)])]),b(y,{modelValue:m.children,"onUpdate:modelValue":h=>m.children=h,level:n.level+1},null,8,["modelValue","onUpdate:modelValue","level"])]))),128))]),_:1},8,["modelValue","data-level"])}}},Q=O(J,[["__scopeId","data-v-ce593bdd"]]),W={class:"grid grid-cols-1 place-items-start gap-6 lg:grid-cols-12"},X={class:"card col-span-1 lg:col-span-8"},Z={class:"card-body"},ee={class:"mb-8 flex items-center justify-between"},te={class:"col-span-1 w-full lg:col-span-4"},ne={class:"card-body card"},se={class:"mb-5"},oe={class:"space-y-4"},le={for:"text",class:"label label-required"},ae={for:"text",class:"label label-required"},ie={for:"href",class:"label label-required"},de={for:"text",class:"label"},re={for:"target",class:"label label-required"},ce={value:"_self"},ue={value:"_blank"},me={value:"_top"},pe={class:"menu-add-update mt-6 flex"},he=["disabled"],fe=["disabled"],be=L({layout:F}),Ve=Object.assign(be,{__name:"Show",props:["info","contents","location"],setup(n){const c=n;T(()=>{t.contents=c.contents});const a=()=>{R.patch(route("admin.sidebar-menu.data.update",c.info.id),{data:t.contents,location:c.location}).then(s=>{s.status==200&&(g.success("Menu item has been updated successfully"),window.location.reload())}).catch(s=>{g.danger(s.response.data.error)})};return(s,o)=>{const _=C("Icon");return v(),k("div",W,[e("div",X,[e("div",Z,[e("div",ee,[e("h4",null,d(s.trans("Sidebar Items")),1),e("button",{type:"button",id:"form-button",class:"btn btn-success",onClick:V(a,["prevent"])},d(s.trans("Save")),1)]),e("div",null,[c.contents?(v(),S(Q,{key:0,modelValue:l(t).contents,"onUpdate:modelValue":o[0]||(o[0]=i=>l(t).contents=i)},null,8,["modelValue"])):A("",!0)])])]),e("div",te,[e("div",ne,[e("h4",se,d(s.trans("Create Sidebar Items")),1),e("form",oe,[e("div",null,[e("label",le,d(s.trans("Text")),1),I(e("input",{type:"text",class:"input",name:"text",id:"text",placeholder:"Text",autocomplete:"off","onUpdate:modelValue":o[1]||(o[1]=i=>l(t).newItem.text=i)},null,512),[[x,l(t).newItem.text]])]),e("div",null,[e("label",ae,d(s.trans("Icon")),1),I(e("input",{type:"text",class:"input",placeholder:"Icon",required:"",autocomplete:"off","onUpdate:modelValue":o[2]||(o[2]=i=>l(t).newItem.icon=i)},null,512),[[x,l(t).newItem.icon]])]),e("div",null,[e("label",ie,d(s.trans("URL")),1),I(e("input",{type:"text",class:"input",id:"href",name:"href",placeholder:"URL",required:"",autocomplete:"off","onUpdate:modelValue":o[3]||(o[3]=i=>l(t).newItem.href=i)},null,512),[[x,l(t).newItem.href]])]),e("div",null,[e("label",de,d(s.trans("Permission")),1),I(e("input",{type:"text",class:"input",placeholder:"Permission",autocomplete:"off","onUpdate:modelValue":o[4]||(o[4]=i=>l(t).newItem.permission=i)},null,512),[[x,l(t).newItem.permission]])]),e("div",null,[e("label",re,d(s.trans("Target")),1),I(e("select",{name:"target",class:"input","onUpdate:modelValue":o[5]||(o[5]=i=>l(t).newItem.target=i)},[e("option",ce,d(s.trans("Self")),1),e("option",ue,d(s.trans("Blank")),1),e("option",me,d(s.trans("Top")),1)],512),[[j,l(t).newItem.target]])])]),e("div",pe,[e("button",{type:"button",id:"btnUpdate",class:"btn btn-update btn-warning mr-2 flex-1 text-white",onClick:o[6]||(o[6]=V((...i)=>l(t).updateItem&&l(t).updateItem(...i),["prevent"])),disabled:!l(t).isEdit},[b(_,{icon:"bx:refresh",class:"text-lg"}),N(" "+d(s.trans("Update")),1)],8,he),e("button",{type:"button",id:"btnAdd",onClick:o[7]||(o[7]=V((...i)=>l(t).addNewItem&&l(t).addNewItem(...i),["prevent"])),class:"btn btn-success flex-1",disabled:l(t).isEdit},[b(_,{icon:"bx:plus",class:"text-lg"}),N(" "+d(s.trans("Add")),1)],8,fe)])])])])}}});export{Ve as default};
