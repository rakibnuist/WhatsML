import{d as V,T as A,k as F,q as O,m as h,r as T,c,o as p,a as i,b as g,l as B,t as d,v as G,u as m,F as v,g as f,h as I}from"./app-CHoD4jNo.js";import{_ as M}from"./AdminLayout-Ddg1XhLg.js";import{V as U}from"./AssetModal-Dh3z8yqV.js";import"./ToastrContainer-DreH4TsU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./InputFieldError-DJP3I4Ws.js";const $={class:"space-y-6"},j={class:"card"},q={class:"card-body"},D={class:"mb-3"},R={class:"label label-md"},w=["placeholder"],L={class:"toggle toggle-sm"},z=["checked"],H={class:"label label-md"},J={class:"col-span-3"},K={class:"flex cursor-pointer items-center gap-2"},Q=["checked","onChange"],W={class:"label"},X={class:"col-span-9 flex flex-col gap-1"},Y=["checked","onChange"],Z={class:"label"},N={class:"card-footer"},ss=["disabled"],es=V({layout:M}),rs=Object.assign(es,{__name:"Edit",props:{permissions_groups:Array,role:Object},setup(u){const r=u,n=A({permissions:[],name:"",_method:"PUT"}),l=F([]);O(()=>{n.permissions=r.role.permissions.map(s=>s.name),n.name=r.role.name,r.permissions_groups.forEach(s=>{k(s)&&l.value.push(s.group_name)})});const b=h(()=>r.permissions_groups.every(s=>l.value.includes(s.group_name))),y=h(()=>r.permissions_groups.reduce((s,e)=>s+e.permissions.length,0)),k=s=>{const e=s.permissions.map(a=>a.name);return e.length>0&&e.every(a=>n.permissions.includes(a))},x=s=>{const e=n.permissions.indexOf(s);e===-1?n.permissions.push(s):n.permissions.splice(e,1)},C=s=>{const a=r.permissions_groups.find(o=>o.group_name===s).permissions.map(o=>o.name);l.value.includes(s)?(l.value=l.value.filter(o=>o!==s),n.permissions=n.permissions.filter(o=>!a.includes(o))):(l.value.push(s),a.forEach(o=>{n.permissions.includes(o)||n.permissions.push(o)}))},P=()=>{n.permissions.length===y.value?(n.permissions=[],l.value=[]):(n.permissions=r.permissions_groups.flatMap(s=>s.permissions.map(e=>e.name)),l.value=r.permissions_groups.map(s=>s.group_name))},E=s=>{x(s),r.permissions_groups.forEach(e=>{const a=e.permissions.map(t=>t.name);if(a.includes(s)){const t=a.every(_=>n.permissions.includes(_)),o=l.value.indexOf(e.group_name);t&&o===-1?l.value.push(e.group_name):!t&&o!==-1&&l.value.splice(o,1)}})},S=()=>{n.post(route("admin.role.update",r.role.id))};return(s,e)=>{const a=T("Icon");return p(),c("div",$,[i("div",j,[i("div",q,[i("div",D,[i("label",R,d(s.trans("Role Name")),1),B(i("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>m(n).name=t),type:"text",class:"input",placeholder:s.trans("Enter role name"),required:""},null,8,w),[[G,m(n).name]])]),g(U),i("label",L,[i("input",{checked:b.value,onChange:P,class:"toggle-input peer sr-only",type:"checkbox"},null,40,z),e[1]||(e[1]=i("div",{class:"toggle-body"},null,-1)),i("span",H,d(s.trans("Check All Permissions")),1)]),e[2]||(e[2]=i("hr",{class:"my-4"},null,-1)),(p(!0),c(v,null,f(u.permissions_groups,t=>(p(),c("div",{key:t.group_name,class:"mb-5 grid grid-cols-12 gap-4"},[i("div",J,[i("label",K,[i("input",{checked:l.value.includes(t.group_name),onChange:o=>C(t.group_name),type:"checkbox",class:"checkbox"},null,40,Q),i("span",W,d(t.group_name),1)])]),i("div",X,[(p(!0),c(v,null,f(t.permissions,o=>(p(),c("label",{key:o.id,class:"flex cursor-pointer items-center gap-2"},[i("input",{checked:m(n).permissions.includes(o.name),onChange:_=>E(o.name),type:"checkbox",class:"checkbox"},null,40,Y),i("span",Z,d(o.name),1)]))),128))])]))),128))]),i("div",N,[i("button",{onClick:S,class:"btn btn-primary",disabled:m(n).processing},[g(a,{icon:"bx:save"}),I(" "+d(s.trans("Update")),1)],8,ss)])])])}}});export{rs as default};
